{
  "timestamp": "2026-01-12T18:32:49.532608",
  "total_tests": 30,
  "passed": 30,
  "failed": 0,
  "errors": 0,
  "total_time": 2.8471198081970215,
  "test_results": [
    {
      "test_id": "TEST_001",
      "description": "Happy Path: Italian vegan+halal wedding in summer (existing case match)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.08341574668884277,
      "iterations": 1,
      "final_menu": {
        "menu_id": 8,
        "menu_name": "Menu 8: Pasta With Chickpeas and Kale",
        "description": "Complete menu featuring Pasta With Chickpeas and Kale as main course",
        "courses": {
          "starter": {
            "recipe_id": 658674,
            "title": "Roasted Sunchoke, Apple, and Onion Soup",
            "servings": 12,
            "price_per_serving": 202.79,
            "ready_in_minutes": 0,
            "ingredients": [
              "sunchokes",
              "onion",
              "apple",
              "vegetable stock",
              "olive oil"
            ],
            "restrictions": [
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free",
              "halal"
            ],
            "instructions": "Preheat oven to 400 degrees\nPeel sunchokes (best you can but don't obsess) and cut into die-sized pieces\nLarge dice onion\nSlice apple in half lengthwise and core\nToss all three in olive oil and place on a sheet pan on the bottom rack\nSet timer for 20 mins and then shake pan\nAfter that, shake and check more frequently\nRemove apples when soft and let cool then peel\nLeave sunchokes and onion in until some of the onion start to char\nAdd roasted vegetables to 4 cups liquid (stock)\nHeat until sunchokes are soft; they may already be from the roasting\nPuree in blender",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [
                  "oven"
                ],
                "temperature": "400 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "peel",
                "where": [
                  "sunchokes"
                ],
                "ingredients": [
                  "sunchokes"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cut",
                "where": [
                  "sunchokes"
                ],
                "ingredients": [
                  "sunchokes"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "dice",
                "where": [
                  "onion"
                ],
                "ingredients": [
                  "onion"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "slice",
                "where": [
                  "apple"
                ],
                "ingredients": [
                  "apple"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "core",
                "where": [
                  "apple"
                ],
                "ingredients": [
                  "apple"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "toss",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [
                  "sunchokes",
                  "onion",
                  "apple",
                  "olive oil"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "place",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "set",
                "where": [],
                "ingredients": [],
                "tools": [
                  "timer"
                ],
                "temperature": null,
                "time": "20 mins"
              },
              {
                "order": 7,
                "preparation_action": "shake",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "shake",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "check",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "remove",
                "where": [
                  "apples"
                ],
                "ingredients": [
                  "apples"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "let cool",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "peel",
                "where": [
                  "apples"
                ],
                "ingredients": [
                  "apples"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "leave",
                "where": [
                  "sunchokes",
                  "onion"
                ],
                "ingredients": [
                  "sunchokes",
                  "onion"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "char",
                "where": [
                  "onion"
                ],
                "ingredients": [
                  "onion"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "sunchokes",
                  "onion",
                  "vegetable stock"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "heat",
                "where": [],
                "ingredients": [
                  "sunchokes",
                  "onion",
                  "vegetable stock"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "puree",
                "where": [],
                "ingredients": [
                  "sunchokes",
                  "onion",
                  "vegetable stock"
                ],
                "tools": [
                  "blender"
                ],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "s&p",
                  "substitute": null,
                  "reason": [
                    "viola restricción 'halal'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "removed",
                  "warning": "Ingrediente ELIMINADO por violar restricción(es): halal"
                }
              ],
              "original_ingredients": [
                "sunchokes",
                "onion",
                "apple",
                "vegetable stock",
                "olive oil",
                "s&p"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 1,
              "ingredients_kept": 0,
              "removed_ingredients": [
                "s&p"
              ],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 654905,
            "title": "Pasta With Chickpeas and Kale",
            "servings": 4,
            "price_per_serving": 243.81,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "chickpeas",
              "garlic",
              "kale",
              "olive oil",
              "parsley",
              "salt and pepper",
              "ziti"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "vegetarian",
              "halal"
            ],
            "instructions": "<ol><li>Set a large pot of water to boil, and add salt. Cut the kale stems into 2-3 inch pieces; chop the leaves coarsely and set aside. Boil the stems until they are nearly tender; then, add the greens. Cook until kale is quite tender but stillbright green. Scoop it out with a slotted spoon, place in a bowl of ice water, and keep pot boiling. When the kale cools, squeeze out excess water, gather it into a mass and chop rather finely. Meanwhile, place olive oil in a large skillet over ve</li><li>Warm the garlic mixture over medium heat, and add the cooked pasta, the chickpeas and the chopped kale.</li><li>Toss well, taste for seasoning, garnish with parsley and serve immediately.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "set",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "water",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "cut",
                "where": [
                  "kale stems"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "chop",
                "where": [
                  "kale leaves"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "boil",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "kale stems",
                  "water",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "boil",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "cook",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "scoop",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [
                  "slotted spoon"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "place",
                "where": [
                  "bowl of ice water"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "keep",
                "where": [
                  "pot"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "cool",
                "where": [
                  "kale"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "squeeze",
                "where": [
                  "kale"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "gather",
                "where": [
                  "kale"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "chop",
                "where": [
                  "kale"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "warm",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [
                  "garlic mixture"
                ],
                "tools": [],
                "temperature": "medium heat",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "add",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [
                  "cooked pasta",
                  "chickpeas",
                  "chopped kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "toss",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "taste",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "garnish",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [
                  "parsley"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "bell pepper",
                "chickpeas",
                "garlic",
                "kale",
                "olive oil",
                "parsley",
                "salt and pepper",
                "ziti"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 646524,
            "title": "Healthy Vegan Red Velvet Brownies",
            "servings": 8,
            "price_per_serving": 41.97,
            "ready_in_minutes": 0,
            "ingredients": [
              "almond extract",
              "apple sauce",
              "baking powder",
              "baking soda",
              "beets",
              "brown sugar",
              "cocoa powder",
              "ground flaxseed",
              "kidney beans",
              "salt",
              "vanilla extract"
            ],
            "restrictions": [
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free",
              "halal"
            ],
            "instructions": "<ol><li>Preheat oven to 350 F.</li><li>Spray an 8x8 inch pan with cooking spray. Set aside.</li><li>In a food processor, puree kidney beans and beets. Transfer to a large bowl.</li><li>Add remaining ingredients and mix by hand until smooth and fully combined.</li><li>Fold batter into the greased pan.</li><li>Bake for 35-40 minutes, turning the pan halfway through.</li><li>When the brownies are done, test them with a toothpick. You want some batter to cling to the toothpick. Do not over bake.</li><li>Let cool completely. Refrigerate for one hour.</li><li>Cut into squares or use cookie cutters to make heart shapes.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [
                  "oven"
                ],
                "temperature": "350 F",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spray",
                "where": [
                  "pan"
                ],
                "ingredients": [],
                "tools": [
                  "cooking spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "set",
                "where": [
                  "aside"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "puree",
                "where": [
                  "food processor"
                ],
                "ingredients": [
                  "kidney beans",
                  "beets"
                ],
                "tools": [
                  "food processor"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "transfer",
                "where": [
                  "large bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "almond extract",
                  "apple sauce",
                  "baking powder",
                  "baking soda",
                  "brown sugar",
                  "cocoa powder",
                  "ground flaxseed",
                  "salt",
                  "vanilla extract"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "mix",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "fold",
                "where": [
                  "greased pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "35-40 minutes"
              },
              {
                "order": 6,
                "preparation_action": "turn",
                "where": [
                  "pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "test",
                "where": [],
                "ingredients": [],
                "tools": [
                  "toothpick"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "completely"
              },
              {
                "order": 8,
                "preparation_action": "refrigerate",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "one hour"
              },
              {
                "order": 9,
                "preparation_action": "cut",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "almond extract",
                "apple sauce",
                "baking powder",
                "baking soda",
                "beets",
                "brown sugar",
                "cocoa powder",
                "ground flaxseed",
                "kidney beans",
                "salt",
                "vanilla extract"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 488.57,
          "price_category": "premium",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Winter",
          "wine_pairing": " No wine pairing",
          "is_kosher": false,
          "is_halal": true,
          "common_dietary_restrictions": [
            "vegan",
            "dairy free",
            "vegetarian",
            "halal"
          ],
          "is_vegetarian": true,
          "is_vegan": true,
          "is_gluten_free": false,
          "is_dairy_free": true,
          "cultura": "Italian",
          "estilo_cocina": "Moderno/Saludable"
        },
        "similarity_features": {
          "total_ingredients_count": 24,
          "complexity_score": 50.0,
          "health_factor": 70.0,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_002",
      "description": "Happy Path: Large congress Mexican no restrictions in winter",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.09997010231018066,
      "iterations": 1,
      "final_menu": {
        "menu_id": 5,
        "menu_name": "Menu 5: Monastery soup",
        "description": "Complete menu featuring Monastery soup as main course",
        "courses": {
          "starter": {
            "recipe_id": 803364,
            "title": "Stuffed Buttercup Squash- Whole Grain Rice & Chicken",
            "servings": 2,
            "price_per_serving": 284.95,
            "ready_in_minutes": 0,
            "ingredients": [
              "pumpkin seeds",
              "corn",
              "chicken sausage",
              "cranberries",
              "grain rice",
              "olive oil",
              "raisins",
              "salt & pepper",
              "sunflower seeds"
            ],
            "restrictions": [
              "dairy free",
              "gluten free"
            ],
            "instructions": "<ol><li>Cut the bottom off the buttercup squash, discard.</li><li>Remove seeds, membranes and discard.  Cut in half.</li><li>Mix filling ingredients together in a bow<span class=\"redactor-invisible-space\">l.<br></span></li><li><span class=\"redactor-invisible-space\">Place squash halves on a cookie sheet, drizzle with olive oil. Spoon filling into squash halves.</span></li><li><span class=\"redactor-invisible-space\">Bake on 350 for 45 minutes or until fork tender.<span class=\"redactor-invisible-space\"></span></span></li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "cut",
                "where": [
                  "buttercup squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "discard",
                "where": [
                  "buttercup squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "remove",
                "where": [
                  "seeds",
                  "membranes"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cut",
                "where": [
                  "buttercup squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "mix",
                "where": [
                  "bow"
                ],
                "ingredients": [
                  "almonds",
                  "buttercup squash",
                  "chicken",
                  "cranberries",
                  "grain rice",
                  "raisins",
                  "salt & pepper",
                  "sunflower seeds"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "place",
                "where": [
                  "cookie sheet"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "drizzle",
                "where": [
                  "buttercup squash"
                ],
                "ingredients": [
                  "olive oil"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "spoon",
                "where": [
                  "buttercup squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "bake",
                "where": [
                  "cookie sheet"
                ],
                "ingredients": [
                  "buttercup squash"
                ],
                "tools": [],
                "temperature": "350",
                "time": "45 minutes"
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "almonds",
                  "substitute": "pumpkin seeds",
                  "reason": [
                    "no pertenece a cultura 'mexican'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 2 candidatos"
                  ],
                  "candidates_found": 0,
                  "action": "substituted"
                },
                {
                  "original": "buttercup squash",
                  "substitute": "corn",
                  "reason": [
                    "no pertenece a cultura 'mexican'"
                  ],
                  "search_attempts": [
                    "ontología (category): 171 candidatos"
                  ],
                  "candidates_found": 171,
                  "action": "substituted"
                },
                {
                  "original": "meat chicken",
                  "substitute": "chicken sausage",
                  "reason": [
                    "no pertenece a cultura 'mexican'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 32 candidatos"
                  ],
                  "candidates_found": 32,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "almonds",
                "buttercup squash",
                "meat chicken",
                "cranberries",
                "grain rice",
                "olive oil",
                "raisins",
                "salt & pepper",
                "sunflower seeds"
              ],
              "ingredients_substituted": 3,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 8,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 5,
                "pending_ingredients": [
                  "cranberries",
                  "grain rice",
                  "raisins",
                  "salt & pepper",
                  "sunflower seeds"
                ],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 652332,
            "title": "Monastery soup",
            "servings": 4,
            "price_per_serving": 156.78,
            "ready_in_minutes": 0,
            "ingredients": [
              "potatoes",
              "onion",
              "garlic",
              "sunflower oil",
              "carrots",
              "leek",
              "celery",
              "broad beans",
              "vegetable stock",
              "parsley",
              "salt and pepper"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "1. Heat the oil in a large pan, add the potato, onion and garlic and saut, covered, for 10 minutes.\n2. Add the carrots, leek  and celery and saut for 5 minutes.\n3. Add broad beans and vegetable stock. Cover and simmer gently for 10 minutes, until the potatoes and broad beans are soft.\n4. Add parsley and salt  and pepper if needed.\nServe with crusty bread.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "heat",
                "where": [
                  "large pan"
                ],
                "ingredients": [
                  "sunflower oil"
                ],
                "tools": [],
                "temperature": "high",
                "time": "10 minutes"
              },
              {
                "order": 2,
                "preparation_action": "add",
                "where": [
                  "large pan"
                ],
                "ingredients": [
                  "potatoes",
                  "onion",
                  "garlic"
                ],
                "tools": [],
                "temperature": null,
                "time": "10 minutes"
              },
              {
                "order": 3,
                "preparation_action": "saut",
                "where": [
                  "large pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [
                  "large pan"
                ],
                "ingredients": [
                  "carrots",
                  "leek",
                  "celery"
                ],
                "tools": [],
                "temperature": null,
                "time": "5 minutes"
              },
              {
                "order": 5,
                "preparation_action": "saut",
                "where": [
                  "large pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "5 minutes"
              },
              {
                "order": 6,
                "preparation_action": "add",
                "where": [
                  "large pan"
                ],
                "ingredients": [
                  "broad beans",
                  "vegetable stock"
                ],
                "tools": [],
                "temperature": null,
                "time": "10 minutes"
              },
              {
                "order": 7,
                "preparation_action": "cover",
                "where": [
                  "large pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "10 minutes"
              },
              {
                "order": 8,
                "preparation_action": "simmer",
                "where": [
                  "large pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "low",
                "time": "10 minutes"
              },
              {
                "order": 9,
                "preparation_action": "add",
                "where": [
                  "large pan"
                ],
                "ingredients": [
                  "parsley",
                  "salt",
                  "pepper"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "potatoes",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'mexican'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "carrots",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'mexican'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "broad beans",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'mexican'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                }
              ],
              "original_ingredients": [
                "potatoes",
                "onion",
                "garlic",
                "sunflower oil",
                "carrots",
                "leek",
                "celery",
                "broad beans",
                "vegetable stock",
                "parsley",
                "salt and pepper"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 3,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 3,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 655515,
            "title": "Pecan Pie",
            "servings": 8,
            "price_per_serving": 155.2,
            "ready_in_minutes": 0,
            "ingredients": [
              "butter",
              "honey",
              "applesauce",
              "flour",
              "pecan halves",
              "pie crust",
              "sugar",
              "vanilla extract"
            ],
            "restrictions": [],
            "instructions": "<ol><li>Beat eggs lightly with an electric mixer or fork until combined.</li><li>Stir in corn syrup, sugar, butter and vanilla extract.</li><li>Stir well.</li><li>Stir in pecan halves and pour filling into crust.</li><li>Bake in a 350 degree preheated oven, for 45 minutes or until knife comes out clean.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "beat",
                "where": [],
                "ingredients": [
                  "eggs"
                ],
                "tools": [
                  "electric mixer",
                  "fork"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "stir",
                "where": [],
                "ingredients": [
                  "corn syrup",
                  "sugar",
                  "butter",
                  "vanilla extract"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "stir",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "stir",
                "where": [],
                "ingredients": [
                  "pecan halves"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "350 degree",
                "time": "45 minutes"
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "corn syrup",
                  "substitute": "honey",
                  "reason": [
                    "no pertenece a cultura 'mexican'"
                  ],
                  "search_attempts": [
                    "ontología (category): 7 candidatos"
                  ],
                  "candidates_found": 7,
                  "action": "substituted"
                },
                {
                  "original": "eggs",
                  "substitute": "applesauce",
                  "reason": [
                    "no pertenece a cultura 'mexican'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 10 candidatos"
                  ],
                  "candidates_found": 0,
                  "action": "substituted"
                },
                {
                  "original": "pecan halves",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'mexican'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                }
              ],
              "original_ingredients": [
                "butter",
                "corn syrup",
                "eggs",
                "flour",
                "pecan halves",
                "pie crust",
                "sugar",
                "vanilla extract"
              ],
              "ingredients_substituted": 2,
              "ingredients_removed": 0,
              "ingredients_kept": 1,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 4,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 1,
                "pending_ingredients": [
                  "pie crust"
                ],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 596.93,
          "price_category": "premium",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Winter",
          "wine_pairing": "Light Red wine or White wine",
          "is_kosher": false,
          "is_halal": true,
          "common_dietary_restrictions": [],
          "is_vegetarian": false,
          "is_vegan": false,
          "is_gluten_free": false,
          "is_dairy_free": false,
          "cultura": "American",
          "estilo_cocina": "Tradicional/Casero"
        },
        "similarity_features": {
          "total_ingredients_count": 28,
          "complexity_score": 56.0,
          "health_factor": 33.3,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_003",
      "description": "Happy Path: Mediterranean family vegetarian+gluten-free in spring",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.10081934928894043,
      "iterations": 1,
      "final_menu": {
        "menu_id": 7,
        "menu_name": "Menu 7: Herbivoracious' White Bean and Kale Soup",
        "description": "Complete menu featuring Herbivoracious' White Bean and Kale Soup as main course",
        "courses": {
          "starter": {
            "recipe_id": 715540,
            "title": "Summer Berry Salad",
            "servings": 1,
            "price_per_serving": 175.37,
            "ready_in_minutes": 0,
            "ingredients": [
              "apples",
              "blackberries",
              "romaine lettuce",
              "strawberries",
              "basalmic vinaigrette"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "Cut up a Granny Smith green apple, strawberries, and add blackberriesMix in with Romaine lettuceToss in some basalmic vinaigrette",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "cut up",
                "where": [],
                "ingredients": [
                  "Granny Smith green apple",
                  "strawberries",
                  "blackberries"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "mix in",
                "where": [
                  "with"
                ],
                "ingredients": [
                  "Romaine lettuce"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "toss in",
                "where": [],
                "ingredients": [
                  "basalmic vinaigrette"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          },
          "main": {
            "recipe_id": 646738,
            "title": "Herbivoracious' White Bean and Kale Soup",
            "servings": 6,
            "price_per_serving": 78.07,
            "ready_in_minutes": 0,
            "ingredients": [
              "olive oil",
              "onion",
              "garlic",
              "carrot",
              "kosher salt",
              "bay leaves",
              "rosemary leaves",
              "the following: parmesan rind)",
              "navy",
              "water",
              "dinosaur kale",
              "juice of lemon"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "PRESSURE COOKER METHOD\n1.In the pressure cooker base, but without pressure, heat the olive oil over medium-high heat. Saut the onion, garlic, carrot, and 1 teaspoon salt until the onion is translucent, about 4 minutes.\n2.Add the bay leaves, rosemary, and your choice(s) of the Parmesan rind, dried porcini, or broth powder. Add the dry beans and water. Bring up to high pressure and cook for 40 minutes, then allow the pressure to release naturally. Open the lid.\n3.Remove the bay leaves and Parmesan rind, if using.\n4.Add the kale and lemon juice and simmer for 10 minutes, until the kale is tender. Taste and adjust the seasoning, then serve, garnished with a generous drizzle of extra-virgin olive oil.\nSTOVETOP METHOD\n1. Cover the beans with several inches of water and soak overnight. Drain the beans and place in a large saucepan. Cover with water by at least 2 inches and bring to a boil. Reduce the heat and simmer the beans until tender, about 1 1/2 to 2 hours. Drain the beans, reserving the bean broth.\n2. In a large saucepan, heat the olive oil over medium-high heat. Saut the onion, garlic, carrot, and 1 teaspoon salt until the onion is translucent, about 4 minutes.\n3. Add 4 cups of the bean broth, the bay leaves, rosemary, and your choice of the Parmesan rind, dried porcini, or broth powder. Bring to a simmer and cook for 30 minutes.\n4. Remove the bay leaves and Parmesan rind, if using.\n5.Add the beans, kale, and lemon juice and simmer for 10 minutes, until the kale is tender. Taste and adjust the seasoning, then serve, garnished with a generous drizzle of extra-virgin olive oil.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "heat",
                "where": [
                  "pressure cooker base"
                ],
                "ingredients": [
                  "olive oil"
                ],
                "tools": [],
                "temperature": "medium-high",
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "saut",
                "where": [
                  "pressure cooker base"
                ],
                "ingredients": [
                  "onion",
                  "garlic",
                  "carrot",
                  "kosher salt"
                ],
                "tools": [],
                "temperature": null,
                "time": "about 4 minutes"
              },
              {
                "order": 2,
                "preparation_action": "add",
                "where": [
                  "pressure cooker base"
                ],
                "ingredients": [
                  "bay leaves",
                  "rosemary",
                  "Parmesan rind",
                  "dried porcini",
                  "broth powder",
                  "dry beans",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cook",
                "where": [
                  "pressure cooker base"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "40 minutes"
              },
              {
                "order": 2,
                "preparation_action": "allow",
                "where": [
                  "pressure cooker base"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "then allow the pressure to release naturally"
              },
              {
                "order": 2,
                "preparation_action": "open",
                "where": [
                  "pressure cooker base"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "remove",
                "where": [
                  "pressure cooker base"
                ],
                "ingredients": [
                  "bay leaves",
                  "Parmesan rind"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [
                  "pressure cooker base"
                ],
                "ingredients": [
                  "kale",
                  "lemon juice"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "simmer",
                "where": [
                  "pressure cooker base"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "10 minutes"
              },
              {
                "order": 4,
                "preparation_action": "taste",
                "where": [
                  "pressure cooker base"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "serve",
                "where": [
                  "pressure cooker base"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "cover",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "soak",
                "where": [],
                "ingredients": [
                  "navy"
                ],
                "tools": [],
                "temperature": null,
                "time": "overnight"
              },
              {
                "order": 1,
                "preparation_action": "drain",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "place",
                "where": [],
                "ingredients": [
                  "navy"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "cover",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "bring",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "reduce",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "simmer",
                "where": [],
                "ingredients": [
                  "navy"
                ],
                "tools": [],
                "temperature": null,
                "time": "about 1 1/2 to 2 hours"
              },
              {
                "order": 1,
                "preparation_action": "drain",
                "where": [],
                "ingredients": [
                  "navy"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "reserve",
                "where": [],
                "ingredients": [
                  "navy"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "heat",
                "where": [],
                "ingredients": [
                  "olive oil"
                ],
                "tools": [],
                "temperature": "medium-high",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "saut",
                "where": [],
                "ingredients": [
                  "onion",
                  "garlic",
                  "carrot",
                  "kosher salt"
                ],
                "tools": [],
                "temperature": null,
                "time": "about 4 minutes"
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "bean broth",
                  "bay leaves",
                  "rosemary",
                  "Parmesan rind",
                  "dried porcini",
                  "broth powder"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "bring",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "cook",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "30 minutes"
              },
              {
                "order": 4,
                "preparation_action": "remove",
                "where": [],
                "ingredients": [
                  "bay leaves",
                  "Parmesan rind"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "navy",
                  "kale",
                  "lemon juice"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "simmer",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "10 minutes"
              },
              {
                "order": 5,
                "preparation_action": "taste",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          },
          "dessert": {
            "recipe_id": 653186,
            "title": "No-Bake Chocolate Peanut Butter Macaroons",
            "servings": 1,
            "price_per_serving": 226.59,
            "ready_in_minutes": 0,
            "ingredients": [
              "milk",
              "coconut",
              "cocoa",
              "butter",
              "brown sugar",
              "vanilla",
              "cooking oats",
              "peanut butter to garnish"
            ],
            "restrictions": [
              "gluten free",
              "vegetarian"
            ],
            "instructions": "In a pot, boil milk, cocoa, butter, and brown sugar for two minutes.\nRemove from heat and add vanilla.\nAdd oats and coconut. Mix well!\nWith a spoon, scoop out mixture onto wax paper and set aside to cool.\nGarnish with a dollop of peanut butter to your hearts desire. The sloppier, the better.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "boil",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "milk",
                  "cocoa",
                  "butter",
                  "brown sugar"
                ],
                "tools": [],
                "temperature": null,
                "time": "two minutes"
              },
              {
                "order": 2,
                "preparation_action": "remove",
                "where": [
                  "heat"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "vanilla",
                  "oats",
                  "coconut"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "mix",
                "where": [],
                "ingredients": [],
                "tools": [
                  "spoon"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "scoop",
                "where": [
                  "wax paper"
                ],
                "ingredients": [],
                "tools": [
                  "spoon"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "set aside",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "to cool"
              },
              {
                "order": 7,
                "preparation_action": "garnish",
                "where": [],
                "ingredients": [
                  "peanut butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          }
        },
        "features": {
          "total_price_per_serving": 480.03,
          "price_category": "premium",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Winter",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "vegetarian",
            "gluten free"
          ],
          "is_vegetarian": true,
          "is_vegan": false,
          "is_gluten_free": true,
          "is_dairy_free": false,
          "cultura": "Mediterranean",
          "estilo_cocina": "Tradicional/Casero"
        },
        "similarity_features": {
          "total_ingredients_count": 25,
          "complexity_score": 50.0,
          "health_factor": 61.7,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_004",
      "description": "Happy Path: American wedding dairy-free in autumn",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.10051560401916504,
      "iterations": 1,
      "final_menu": {
        "menu_id": 2,
        "menu_name": "Menu 2: Simple Squash Salad",
        "description": "Complete menu featuring Simple Squash Salad as main course",
        "courses": {
          "starter": {
            "recipe_id": 650871,
            "title": "Maple & Curry Acorn Squash",
            "servings": 3,
            "price_per_serving": 57.52,
            "ready_in_minutes": 0,
            "ingredients": [
              "acorn squash",
              "curry powder",
              "maple syrup",
              "olive oil",
              "salt"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Preheat oven to 400 F. Line a baking sheet with parchment paper or a silicone mat.</li><li>Rinse the outside of the acorn squash and then chop it in half. Seed the squash and chop off the stem. Next, slice it into one-inch wedges. I like use the natural grooves on the squash as a guide for thickness.</li><li>Place the sliced acorn squash in a medium-sized bowl. Add the rest of the ingredients to the bowl and stir until everything is well incorporated.</li><li>Lay the acorn squash in a single layer on top of the lined baking sheet, cut side down.</li><li>Bake for about 15 minutes. Flip the acorn squash slices to the other side so that both sides will be browned equally.</li><li>Bake the squash for another 10 to 15 minutes or until the pieces can be easily pierced with a fork.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "400 F",
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "line",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [
                  "parchment paper",
                  "silicone mat"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "rinse",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "seed",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "slice",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "place",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "curry powder",
                  "maple syrup",
                  "olive oil",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "stir",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "lay",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "15 minutes"
              },
              {
                "order": 5,
                "preparation_action": "flip",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "10 to 15 minutes"
              }
            ]
          },
          "main": {
            "recipe_id": 660146,
            "title": "Simple Squash Salad",
            "servings": 6,
            "price_per_serving": 57.39,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "pepper",
              "parsley",
              "garlic",
              "garlic powder",
              "capers plus 2 tablespoons caper juice",
              "lemon",
              "onion",
              "oregano",
              "pepper flakes",
              "salt",
              "sugar",
              "vinegar",
              "zucchini"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Combine all of the ingredients the salad ingredients in a bowl.</li><li>Combine all of the dressing ingredients in a cup and stir, adjust the ingredients to taste. </li><li> Pour this over the salad and toss. </li><li> Let the salad sit in the refrigerator for a few hours before serving.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "pepper",
                  "parsley",
                  "garlic",
                  "garlic powder",
                  "capers",
                  "caper juice",
                  "lemon",
                  "onion",
                  "oregano",
                  "pepper flakes",
                  "salt",
                  "sugar",
                  "vinegar",
                  "zucchini"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [
                  "cup"
                ],
                "ingredients": [
                  "dressing ingredients"
                ],
                "tools": [
                  "stir"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "pour",
                "where": [],
                "ingredients": [
                  "dressing"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "toss",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "a few hours"
              }
            ]
          },
          "dessert": {
            "recipe_id": 665330,
            "title": "Wild Blackberry Sorbet With Garden Mint & Lavender",
            "servings": 4,
            "price_per_serving": 102.5,
            "ready_in_minutes": 0,
            "ingredients": [
              "blackberries",
              "sugar",
              "water",
              "mint leaves",
              "lavender",
              "ice water"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "Lay the clean, drained berries in a single layer on a cookie sheet and place in the freezer until frozen through. It is best to do both this and the next step the day or night before you plan to make the sorbet - just make sure you leave enough time for everything to freeze.\nMake the herb-infused simple syrup by combining the water and sugar in a small heavy-bottomed saucepan and heat over a medium flame until it comes to a boil. Turn it off and let cool completely.\nStrain out the mint leaves and lavender and pour the cooled syrup into an ice cube tray - should make roughly 4 syrup cubes. Place the tray in the freezer until syrup is frozen (the cubes may remain a little mushy as a result of all the sugar.)\nOnce the berries and herb-infused syrup cubes have frozen, you can make the sorbet. Place the frozen berries and syrup cubes in the bowl of a cuisinart or blender and add a few teaspoons of ice water to aid in blending. Continue to process or blend, adding small amounts of the ice water as needed, until smooth.\nServe, topped with a sprig of mint leaves and/or lavender.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "lay",
                "where": [
                  "cookie sheet"
                ],
                "ingredients": [
                  "berries"
                ],
                "tools": [],
                "temperature": null,
                "time": "until frozen through"
              },
              {
                "order": 2,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "water",
                  "sugar"
                ],
                "tools": [
                  "saucepan"
                ],
                "temperature": "medium",
                "time": "until it comes to a boil"
              },
              {
                "order": 3,
                "preparation_action": "turn off and let cool",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "completely"
              },
              {
                "order": 4,
                "preparation_action": "strain and pour",
                "where": [
                  "ice cube tray"
                ],
                "ingredients": [
                  "mint leaves",
                  "lavender",
                  "syrup"
                ],
                "tools": [],
                "temperature": null,
                "time": "until syrup is frozen"
              },
              {
                "order": 5,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "berries",
                  "syrup cubes",
                  "ice water"
                ],
                "tools": [
                  "cuisinart",
                  "blender"
                ],
                "temperature": null,
                "time": "until smooth"
              },
              {
                "order": 6,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          }
        },
        "features": {
          "total_price_per_serving": 217.41,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "vegetarian",
            "vegan",
            "dairy free",
            "gluten free"
          ],
          "is_vegetarian": true,
          "is_vegan": true,
          "is_gluten_free": true,
          "is_dairy_free": true,
          "cultura": "American",
          "estilo_cocina": "Moderno"
        },
        "similarity_features": {
          "total_ingredients_count": 23,
          "complexity_score": 50.0,
          "health_factor": 75.0,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_005",
      "description": "Happy Path: French congress kosher+vegan high budget any season",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.09963750839233398,
      "iterations": 1,
      "final_menu": {
        "menu_id": 2,
        "menu_name": "Menu 2: Simple Squash Salad",
        "description": "Complete menu featuring Simple Squash Salad as main course",
        "courses": {
          "starter": {
            "recipe_id": 650871,
            "title": "Maple & Curry Acorn Squash",
            "servings": 3,
            "price_per_serving": 57.52,
            "ready_in_minutes": 0,
            "ingredients": [
              "acorn squash",
              "curry powder",
              "maple syrup",
              "olive oil",
              "salt"
            ],
            "restrictions": [
              "kosher",
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free"
            ],
            "instructions": "<ol><li>Preheat oven to 400 F. Line a baking sheet with parchment paper or a silicone mat.</li><li>Rinse the outside of the acorn squash and then chop it in half. Seed the squash and chop off the stem. Next, slice it into one-inch wedges. I like use the natural grooves on the squash as a guide for thickness.</li><li>Place the sliced acorn squash in a medium-sized bowl. Add the rest of the ingredients to the bowl and stir until everything is well incorporated.</li><li>Lay the acorn squash in a single layer on top of the lined baking sheet, cut side down.</li><li>Bake for about 15 minutes. Flip the acorn squash slices to the other side so that both sides will be browned equally.</li><li>Bake the squash for another 10 to 15 minutes or until the pieces can be easily pierced with a fork.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "400 F",
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "line",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [
                  "parchment paper",
                  "silicone mat"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "rinse",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "seed",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "slice",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "place",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "curry powder",
                  "maple syrup",
                  "olive oil",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "stir",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "lay",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "15 minutes"
              },
              {
                "order": 5,
                "preparation_action": "flip",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "10 to 15 minutes"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "acorn squash",
                "curry powder",
                "maple syrup",
                "olive oil",
                "salt"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 660146,
            "title": "Simple Squash Salad",
            "servings": 6,
            "price_per_serving": 57.39,
            "ready_in_minutes": 0,
            "ingredients": [
              "thumb sized piece of ginger",
              "pepper",
              "parsley",
              "garlic",
              "thumb sized piece of ginger",
              "capers plus caper juice",
              "lemon",
              "onion",
              "oregano",
              "pepper flakes",
              "salt",
              "sugar",
              "vinegar",
              "zucchini"
            ],
            "restrictions": [
              "kosher",
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free"
            ],
            "instructions": "<ol><li>Combine all of the ingredients the salad ingredients in a bowl.</li><li>Combine all of the dressing ingredients in a cup and stir, adjust the ingredients to taste. </li><li> Pour this over the salad and toss. </li><li> Let the salad sit in the refrigerator for a few hours before serving.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "pepper",
                  "parsley",
                  "garlic",
                  "garlic powder",
                  "capers",
                  "caper juice",
                  "lemon",
                  "onion",
                  "oregano",
                  "pepper flakes",
                  "salt",
                  "sugar",
                  "vinegar",
                  "zucchini"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [
                  "cup"
                ],
                "ingredients": [
                  "dressing ingredients"
                ],
                "tools": [
                  "stir"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "pour",
                "where": [],
                "ingredients": [
                  "dressing"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "toss",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "a few hours"
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "bell pepper",
                  "substitute": "thumb sized piece of ginger",
                  "reason": [
                    "no pertenece a cultura 'french'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 84 candidatos"
                  ],
                  "candidates_found": 84,
                  "action": "substituted"
                },
                {
                  "original": "garlic powder",
                  "substitute": "thumb sized piece of ginger",
                  "reason": [
                    "no pertenece a cultura 'french'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 84 candidatos"
                  ],
                  "candidates_found": 84,
                  "action": "substituted"
                },
                {
                  "original": "capers plus 2 tablespoons caper juice",
                  "substitute": "capers plus caper juice",
                  "reason": [
                    "no pertenece a cultura 'french'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 2 candidatos"
                  ],
                  "candidates_found": 2,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "bell pepper",
                "pepper",
                "parsley",
                "garlic",
                "garlic powder",
                "capers plus 2 tablespoons caper juice",
                "lemon",
                "onion",
                "oregano",
                "pepper flakes",
                "salt",
                "sugar",
                "vinegar",
                "zucchini"
              ],
              "ingredients_substituted": 3,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 8,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 5,
                "pending_ingredients": [
                  "lemon",
                  "oregano",
                  "pepper flakes",
                  "vinegar",
                  "zucchini"
                ],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 665330,
            "title": "Wild Blackberry Sorbet With Garden Mint & Lavender",
            "servings": 4,
            "price_per_serving": 102.5,
            "ready_in_minutes": 0,
            "ingredients": [
              "blackberries",
              "sugar",
              "water",
              "mint leaves",
              "chives and dill",
              "ice water"
            ],
            "restrictions": [
              "kosher",
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free"
            ],
            "instructions": "Lay the clean, drained berries in a single layer on a cookie sheet and place in the freezer until frozen through. It is best to do both this and the next step the day or night before you plan to make the sorbet - just make sure you leave enough time for everything to freeze.\nMake the herb-infused simple syrup by combining the water and sugar in a small heavy-bottomed saucepan and heat over a medium flame until it comes to a boil. Turn it off and let cool completely.\nStrain out the mint leaves and lavender and pour the cooled syrup into an ice cube tray - should make roughly 4 syrup cubes. Place the tray in the freezer until syrup is frozen (the cubes may remain a little mushy as a result of all the sugar.)\nOnce the berries and herb-infused syrup cubes have frozen, you can make the sorbet. Place the frozen berries and syrup cubes in the bowl of a cuisinart or blender and add a few teaspoons of ice water to aid in blending. Continue to process or blend, adding small amounts of the ice water as needed, until smooth.\nServe, topped with a sprig of mint leaves and/or lavender.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "lay",
                "where": [
                  "cookie sheet"
                ],
                "ingredients": [
                  "berries"
                ],
                "tools": [],
                "temperature": null,
                "time": "until frozen through"
              },
              {
                "order": 2,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "water",
                  "sugar"
                ],
                "tools": [
                  "saucepan"
                ],
                "temperature": "medium",
                "time": "until it comes to a boil"
              },
              {
                "order": 3,
                "preparation_action": "turn off and let cool",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "completely"
              },
              {
                "order": 4,
                "preparation_action": "strain and pour",
                "where": [
                  "ice cube tray"
                ],
                "ingredients": [
                  "mint leaves",
                  "lavender",
                  "syrup"
                ],
                "tools": [],
                "temperature": null,
                "time": "until syrup is frozen"
              },
              {
                "order": 5,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "berries",
                  "syrup cubes",
                  "ice water"
                ],
                "tools": [
                  "cuisinart",
                  "blender"
                ],
                "temperature": null,
                "time": "until smooth"
              },
              {
                "order": 6,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "blackberries",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'french'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "mint leaves",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'french'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "lavender",
                  "substitute": "chives and dill",
                  "reason": [
                    "no pertenece a cultura 'french'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 22 candidatos"
                  ],
                  "candidates_found": 22,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "blackberries",
                "sugar",
                "water",
                "mint leaves",
                "lavender",
                "ice water"
              ],
              "ingredients_substituted": 1,
              "ingredients_removed": 0,
              "ingredients_kept": 2,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 3,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 217.41,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "kosher",
            "dairy free",
            "vegetarian",
            "vegan",
            "gluten free"
          ],
          "is_vegetarian": true,
          "is_vegan": true,
          "is_gluten_free": true,
          "is_dairy_free": true,
          "cultura": "American",
          "estilo_cocina": "Moderno"
        },
        "similarity_features": {
          "total_ingredients_count": 23,
          "complexity_score": 50.0,
          "health_factor": 75.0,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_006",
      "description": "Edge Case: Single person family event (min people)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.11024999618530273,
      "iterations": 1,
      "final_menu": {
        "menu_id": 1,
        "menu_name": "Menu 1: Corn Salsa",
        "description": "Complete menu featuring Corn Salsa as main course",
        "courses": {
          "starter": {
            "recipe_id": 640062,
            "title": "Corn Avocado Salsa",
            "servings": 2,
            "price_per_serving": 130.73,
            "ready_in_minutes": 0,
            "ingredients": [
              "avocado",
              "balsamic vinegar",
              "cumin",
              "corn",
              "garlic",
              "bell pepper"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Preheat oven to 375 degrees.</li><li>Spread corn flat on a baking sheet.</li><li>Spray lightly with olive oil spray.</li><li>Roast corn in the oven for about 8-10 minutes. (Be careful not to brown too much or burn.)</li><li>Remove from heat and allow to cool.</li><li>Finely chop red pepper and garlic and mix in a bowl.</li><li>Peel and coarsely chop avocado and add to bowl.</li><li>Add cooled corn.</li><li>Mix in cumin and vinegar and blend well.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "375 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "spray",
                "where": [],
                "ingredients": [],
                "tools": [
                  "olive oil spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "roast",
                "where": [
                  "oven"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": "8-10 minutes"
              },
              {
                "order": 5,
                "preparation_action": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "allow",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "red pepper",
                  "garlic"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "peel",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "cumin",
                  "vinegar"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "blend",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "avocado",
                "balsamic vinegar",
                "cumin",
                "corn",
                "garlic",
                "bell pepper"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 640104,
            "title": "Corn Salsa",
            "servings": 4,
            "price_per_serving": 150.92,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "celery",
              "ears of corn - boil and from the cob",
              "basil",
              "garlic",
              "jalapeño",
              "onion",
              "salt",
              "sugar",
              "marinated jalapeno",
              "vine tomato",
              "vinegar"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Combine all of the above ingredients in a bowl.</li><li>Combine the ingredients for the dressing and add to the salsa.</li><li>Serve chilled.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "celery",
                  "ears of corn",
                  "basil",
                  "garlic",
                  "jalapeño",
                  "onion",
                  "salt",
                  "sugar",
                  "pickle",
                  "vine tomato"
                ],
                "tools": [
                  "bowl"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [],
                "ingredients": [
                  "vinegar",
                  "salsa"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "chilled",
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "ears of corn - boil and from the cob",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "jalapeño",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "pickle",
                  "substitute": "marinated jalapeno",
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 1 candidatos"
                  ],
                  "candidates_found": 1,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "bell pepper",
                "celery",
                "ears of corn - boil and from the cob",
                "basil",
                "garlic",
                "jalapeño",
                "onion",
                "salt",
                "sugar",
                "pickle",
                "vine tomato",
                "vinegar"
              ],
              "ingredients_substituted": 1,
              "ingredients_removed": 0,
              "ingredients_kept": 2,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 4,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 1,
                "pending_ingredients": [
                  "vine tomato"
                ],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 655202,
            "title": "Peanut Brittle",
            "servings": 4,
            "price_per_serving": 107.1,
            "ready_in_minutes": 0,
            "ingredients": [
              "butter",
              "carbonated water",
              "strawberry",
              "honey",
              "peanuts",
              "salt",
              "sugar",
              "water"
            ],
            "restrictions": [
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Pour sugar, corn syrup and water into saucepan. Cook, stirring only until sugar is dissolved. Continue cooking until sugar begins to turn light brown (300 degrees) by candy thermometer. Remove from heat. Add salt, soda, butter and stir as little as possible, only to mix well. Stir in peanuts and coconut.Spread on a greased sheet of waxed paper set on top of a baking sheet and let the mixture cool and harden.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "pour",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cook",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [
                  "candy thermometer"
                ],
                "temperature": "300 degrees",
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "peanuts",
                  "coconut"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "cool and harden"
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "soda",
                  "substitute": "carbonated water",
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 3 candidatos"
                  ],
                  "candidates_found": 3,
                  "action": "substituted"
                },
                {
                  "original": "coconut",
                  "substitute": "strawberry",
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (category): 33 candidatos"
                  ],
                  "candidates_found": 33,
                  "action": "substituted"
                },
                {
                  "original": "corn syrup",
                  "substitute": "honey",
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (category): 7 candidatos"
                  ],
                  "candidates_found": 7,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "butter",
                "soda",
                "coconut",
                "corn syrup",
                "peanuts",
                "salt",
                "sugar",
                "water"
              ],
              "ingredients_substituted": 3,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 4,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 1,
                "pending_ingredients": [
                  "peanuts"
                ],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 388.75,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "gluten free",
            "vegetarian"
          ],
          "is_vegetarian": true,
          "is_vegan": false,
          "is_gluten_free": true,
          "is_dairy_free": false,
          "cultura": "American",
          "estilo_cocina": "Tradicional"
        },
        "similarity_features": {
          "total_ingredients_count": 22,
          "complexity_score": 52.0,
          "health_factor": 61.7,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_007",
      "description": "Culture Test: Japanese wedding vegan in winter",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.12872886657714844,
      "iterations": 1,
      "final_menu": {
        "menu_id": 8,
        "menu_name": "Menu 8: Pasta With Chickpeas and Kale",
        "description": "Complete menu featuring Pasta With Chickpeas and Kale as main course",
        "courses": {
          "starter": {
            "recipe_id": 658674,
            "title": "Roasted Sunchoke, Apple, and Onion Soup",
            "servings": 12,
            "price_per_serving": 202.79,
            "ready_in_minutes": 0,
            "ingredients": [
              "sunchokes",
              "onion",
              "pineapple juice",
              "vegetable broth",
              "olive oil",
              "s&p"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "Preheat oven to 400 degrees\nPeel sunchokes (best you can but don't obsess) and cut into die-sized pieces\nLarge dice onion\nSlice apple in half lengthwise and core\nToss all three in olive oil and place on a sheet pan on the bottom rack\nSet timer for 20 mins and then shake pan\nAfter that, shake and check more frequently\nRemove apples when soft and let cool then peel\nLeave sunchokes and onion in until some of the onion start to char\nAdd roasted vegetables to 4 cups liquid (stock)\nHeat until sunchokes are soft; they may already be from the roasting\nPuree in blender",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [
                  "oven"
                ],
                "temperature": "400 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "peel",
                "where": [
                  "sunchokes"
                ],
                "ingredients": [
                  "sunchokes"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cut",
                "where": [
                  "sunchokes"
                ],
                "ingredients": [
                  "sunchokes"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "dice",
                "where": [
                  "onion"
                ],
                "ingredients": [
                  "onion"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "slice",
                "where": [
                  "apple"
                ],
                "ingredients": [
                  "apple"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "core",
                "where": [
                  "apple"
                ],
                "ingredients": [
                  "apple"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "toss",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [
                  "sunchokes",
                  "onion",
                  "apple",
                  "olive oil"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "place",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "set",
                "where": [],
                "ingredients": [],
                "tools": [
                  "timer"
                ],
                "temperature": null,
                "time": "20 mins"
              },
              {
                "order": 7,
                "preparation_action": "shake",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "shake",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "check",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "remove",
                "where": [
                  "apples"
                ],
                "ingredients": [
                  "apples"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "let cool",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "peel",
                "where": [
                  "apples"
                ],
                "ingredients": [
                  "apples"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "leave",
                "where": [
                  "sunchokes",
                  "onion"
                ],
                "ingredients": [
                  "sunchokes",
                  "onion"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "char",
                "where": [
                  "onion"
                ],
                "ingredients": [
                  "onion"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "sunchokes",
                  "onion",
                  "vegetable stock"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "heat",
                "where": [],
                "ingredients": [
                  "sunchokes",
                  "onion",
                  "vegetable stock"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "puree",
                "where": [],
                "ingredients": [
                  "sunchokes",
                  "onion",
                  "vegetable stock"
                ],
                "tools": [
                  "blender"
                ],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "sunchokes",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'japanese'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "apple",
                  "substitute": "pineapple juice",
                  "reason": [
                    "no pertenece a cultura 'japanese'"
                  ],
                  "search_attempts": [
                    "ontología (category): 33 candidatos"
                  ],
                  "candidates_found": 33,
                  "action": "substituted"
                },
                {
                  "original": "vegetable stock",
                  "substitute": "vegetable broth",
                  "reason": [
                    "no pertenece a cultura 'japanese'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 5 candidatos"
                  ],
                  "candidates_found": 5,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "sunchokes",
                "onion",
                "apple",
                "vegetable stock",
                "olive oil",
                "s&p"
              ],
              "ingredients_substituted": 2,
              "ingredients_removed": 0,
              "ingredients_kept": 1,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 4,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 1,
                "pending_ingredients": [
                  "s&p"
                ],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 654905,
            "title": "Pasta With Chickpeas and Kale",
            "servings": 4,
            "price_per_serving": 243.81,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "chickpeas",
              "garlic",
              "corn",
              "olive oil",
              "parsley",
              "salt and pepper",
              "elbow macaroni"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Set a large pot of water to boil, and add salt. Cut the kale stems into 2-3 inch pieces; chop the leaves coarsely and set aside. Boil the stems until they are nearly tender; then, add the greens. Cook until kale is quite tender but stillbright green. Scoop it out with a slotted spoon, place in a bowl of ice water, and keep pot boiling. When the kale cools, squeeze out excess water, gather it into a mass and chop rather finely. Meanwhile, place olive oil in a large skillet over ve</li><li>Warm the garlic mixture over medium heat, and add the cooked pasta, the chickpeas and the chopped kale.</li><li>Toss well, taste for seasoning, garnish with parsley and serve immediately.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "set",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "water",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "cut",
                "where": [
                  "kale stems"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "chop",
                "where": [
                  "kale leaves"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "boil",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "kale stems",
                  "water",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "boil",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "cook",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "scoop",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [
                  "slotted spoon"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "place",
                "where": [
                  "bowl of ice water"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "keep",
                "where": [
                  "pot"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "cool",
                "where": [
                  "kale"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "squeeze",
                "where": [
                  "kale"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "gather",
                "where": [
                  "kale"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "chop",
                "where": [
                  "kale"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "warm",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [
                  "garlic mixture"
                ],
                "tools": [],
                "temperature": "medium heat",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "add",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [
                  "cooked pasta",
                  "chickpeas",
                  "chopped kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "toss",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "taste",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "garnish",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [
                  "parsley"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "chickpeas",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'japanese'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "kale",
                  "substitute": "corn",
                  "reason": [
                    "no pertenece a cultura 'japanese'"
                  ],
                  "search_attempts": [
                    "ontología (category): 80 candidatos"
                  ],
                  "candidates_found": 80,
                  "action": "substituted"
                },
                {
                  "original": "ziti",
                  "substitute": "elbow macaroni",
                  "reason": [
                    "no pertenece a cultura 'japanese'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 8 candidatos"
                  ],
                  "candidates_found": 8,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "bell pepper",
                "chickpeas",
                "garlic",
                "kale",
                "olive oil",
                "parsley",
                "salt and pepper",
                "ziti"
              ],
              "ingredients_substituted": 2,
              "ingredients_removed": 0,
              "ingredients_kept": 1,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 3,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 646524,
            "title": "Healthy Vegan Red Velvet Brownies",
            "servings": 8,
            "price_per_serving": 41.97,
            "ready_in_minutes": 0,
            "ingredients": [
              "nut",
              "tomato paste",
              "cornstarch",
              "baking soda",
              "beets",
              "brown sugar",
              "cocoa powder",
              "ground flaxseed",
              "kidney beans",
              "salt",
              "vanilla extract"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Preheat oven to 350 F.</li><li>Spray an 8x8 inch pan with cooking spray. Set aside.</li><li>In a food processor, puree kidney beans and beets. Transfer to a large bowl.</li><li>Add remaining ingredients and mix by hand until smooth and fully combined.</li><li>Fold batter into the greased pan.</li><li>Bake for 35-40 minutes, turning the pan halfway through.</li><li>When the brownies are done, test them with a toothpick. You want some batter to cling to the toothpick. Do not over bake.</li><li>Let cool completely. Refrigerate for one hour.</li><li>Cut into squares or use cookie cutters to make heart shapes.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [
                  "oven"
                ],
                "temperature": "350 F",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spray",
                "where": [
                  "pan"
                ],
                "ingredients": [],
                "tools": [
                  "cooking spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "set",
                "where": [
                  "aside"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "puree",
                "where": [
                  "food processor"
                ],
                "ingredients": [
                  "kidney beans",
                  "beets"
                ],
                "tools": [
                  "food processor"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "transfer",
                "where": [
                  "large bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "almond extract",
                  "apple sauce",
                  "baking powder",
                  "baking soda",
                  "brown sugar",
                  "cocoa powder",
                  "ground flaxseed",
                  "salt",
                  "vanilla extract"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "mix",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "fold",
                "where": [
                  "greased pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "35-40 minutes"
              },
              {
                "order": 6,
                "preparation_action": "turn",
                "where": [
                  "pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "test",
                "where": [],
                "ingredients": [],
                "tools": [
                  "toothpick"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "completely"
              },
              {
                "order": 8,
                "preparation_action": "refrigerate",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "one hour"
              },
              {
                "order": 9,
                "preparation_action": "cut",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "almond extract",
                  "substitute": "nut",
                  "reason": [
                    "no pertenece a cultura 'japanese'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 23 candidatos"
                  ],
                  "candidates_found": 23,
                  "action": "substituted"
                },
                {
                  "original": "apple sauce",
                  "substitute": "tomato paste",
                  "reason": [
                    "no pertenece a cultura 'japanese'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 21 candidatos"
                  ],
                  "candidates_found": 21,
                  "action": "substituted"
                },
                {
                  "original": "baking powder",
                  "substitute": "cornstarch",
                  "reason": [
                    "no pertenece a cultura 'japanese'"
                  ],
                  "search_attempts": [
                    "ontología (category): 2 candidatos"
                  ],
                  "candidates_found": 2,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "almond extract",
                "apple sauce",
                "baking powder",
                "baking soda",
                "beets",
                "brown sugar",
                "cocoa powder",
                "ground flaxseed",
                "kidney beans",
                "salt",
                "vanilla extract"
              ],
              "ingredients_substituted": 3,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 9,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 6,
                "pending_ingredients": [
                  "baking soda",
                  "beets",
                  "cocoa powder",
                  "ground flaxseed",
                  "kidney beans",
                  "vanilla extract"
                ],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 488.57,
          "price_category": "premium",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Winter",
          "wine_pairing": " No wine pairing",
          "is_kosher": false,
          "is_halal": true,
          "common_dietary_restrictions": [
            "vegan",
            "dairy free",
            "vegetarian"
          ],
          "is_vegetarian": true,
          "is_vegan": true,
          "is_gluten_free": false,
          "is_dairy_free": true,
          "cultura": "Italian",
          "estilo_cocina": "Moderno/Saludable"
        },
        "similarity_features": {
          "total_ingredients_count": 24,
          "complexity_score": 50.0,
          "health_factor": 70.0,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_008",
      "description": "Restriction Test: Duplicate restrictions + format variants",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.07872152328491211,
      "iterations": 1,
      "final_menu": {
        "menu_id": 2,
        "menu_name": "Menu 2: Simple Squash Salad",
        "description": "Complete menu featuring Simple Squash Salad as main course",
        "courses": {
          "starter": {
            "recipe_id": 650871,
            "title": "Maple & Curry Acorn Squash",
            "servings": 3,
            "price_per_serving": 57.52,
            "ready_in_minutes": 0,
            "ingredients": [
              "acorn squash",
              "curry powder",
              "maple syrup",
              "olive oil",
              "salt"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Preheat oven to 400 F. Line a baking sheet with parchment paper or a silicone mat.</li><li>Rinse the outside of the acorn squash and then chop it in half. Seed the squash and chop off the stem. Next, slice it into one-inch wedges. I like use the natural grooves on the squash as a guide for thickness.</li><li>Place the sliced acorn squash in a medium-sized bowl. Add the rest of the ingredients to the bowl and stir until everything is well incorporated.</li><li>Lay the acorn squash in a single layer on top of the lined baking sheet, cut side down.</li><li>Bake for about 15 minutes. Flip the acorn squash slices to the other side so that both sides will be browned equally.</li><li>Bake the squash for another 10 to 15 minutes or until the pieces can be easily pierced with a fork.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "400 F",
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "line",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [
                  "parchment paper",
                  "silicone mat"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "rinse",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "seed",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "slice",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "place",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "curry powder",
                  "maple syrup",
                  "olive oil",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "stir",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "lay",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "15 minutes"
              },
              {
                "order": 5,
                "preparation_action": "flip",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "10 to 15 minutes"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "acorn squash",
                "curry powder",
                "maple syrup",
                "olive oil",
                "salt"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 660146,
            "title": "Simple Squash Salad",
            "servings": 6,
            "price_per_serving": 57.39,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "pepper",
              "parsley",
              "garlic",
              "garlic powder",
              "capers plus 2 tablespoons caper juice",
              "lemon",
              "onion",
              "oregano",
              "pepper flakes",
              "salt",
              "sugar",
              "vinegar",
              "zucchini"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Combine all of the ingredients the salad ingredients in a bowl.</li><li>Combine all of the dressing ingredients in a cup and stir, adjust the ingredients to taste. </li><li> Pour this over the salad and toss. </li><li> Let the salad sit in the refrigerator for a few hours before serving.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "pepper",
                  "parsley",
                  "garlic",
                  "garlic powder",
                  "capers",
                  "caper juice",
                  "lemon",
                  "onion",
                  "oregano",
                  "pepper flakes",
                  "salt",
                  "sugar",
                  "vinegar",
                  "zucchini"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [
                  "cup"
                ],
                "ingredients": [
                  "dressing ingredients"
                ],
                "tools": [
                  "stir"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "pour",
                "where": [],
                "ingredients": [
                  "dressing"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "toss",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "a few hours"
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "pepper flakes",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'mediterranean'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                }
              ],
              "original_ingredients": [
                "bell pepper",
                "pepper",
                "parsley",
                "garlic",
                "garlic powder",
                "capers plus 2 tablespoons caper juice",
                "lemon",
                "onion",
                "oregano",
                "pepper flakes",
                "salt",
                "sugar",
                "vinegar",
                "zucchini"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 1,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 1,
                "culture_changed_this_round": 1,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 665330,
            "title": "Wild Blackberry Sorbet With Garden Mint & Lavender",
            "servings": 4,
            "price_per_serving": 102.5,
            "ready_in_minutes": 0,
            "ingredients": [
              "blackberries",
              "sugar",
              "water",
              "mint leaves",
              "chives and dill",
              "ice water"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "Lay the clean, drained berries in a single layer on a cookie sheet and place in the freezer until frozen through. It is best to do both this and the next step the day or night before you plan to make the sorbet - just make sure you leave enough time for everything to freeze.\nMake the herb-infused simple syrup by combining the water and sugar in a small heavy-bottomed saucepan and heat over a medium flame until it comes to a boil. Turn it off and let cool completely.\nStrain out the mint leaves and lavender and pour the cooled syrup into an ice cube tray - should make roughly 4 syrup cubes. Place the tray in the freezer until syrup is frozen (the cubes may remain a little mushy as a result of all the sugar.)\nOnce the berries and herb-infused syrup cubes have frozen, you can make the sorbet. Place the frozen berries and syrup cubes in the bowl of a cuisinart or blender and add a few teaspoons of ice water to aid in blending. Continue to process or blend, adding small amounts of the ice water as needed, until smooth.\nServe, topped with a sprig of mint leaves and/or lavender.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "lay",
                "where": [
                  "cookie sheet"
                ],
                "ingredients": [
                  "berries"
                ],
                "tools": [],
                "temperature": null,
                "time": "until frozen through"
              },
              {
                "order": 2,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "water",
                  "sugar"
                ],
                "tools": [
                  "saucepan"
                ],
                "temperature": "medium",
                "time": "until it comes to a boil"
              },
              {
                "order": 3,
                "preparation_action": "turn off and let cool",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "completely"
              },
              {
                "order": 4,
                "preparation_action": "strain and pour",
                "where": [
                  "ice cube tray"
                ],
                "ingredients": [
                  "mint leaves",
                  "lavender",
                  "syrup"
                ],
                "tools": [],
                "temperature": null,
                "time": "until syrup is frozen"
              },
              {
                "order": 5,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "berries",
                  "syrup cubes",
                  "ice water"
                ],
                "tools": [
                  "cuisinart",
                  "blender"
                ],
                "temperature": null,
                "time": "until smooth"
              },
              {
                "order": 6,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "blackberries",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'mediterranean'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "mint leaves",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'mediterranean'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "lavender",
                  "substitute": "chives and dill",
                  "reason": [
                    "no pertenece a cultura 'mediterranean'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 22 candidatos"
                  ],
                  "candidates_found": 22,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "blackberries",
                "sugar",
                "water",
                "mint leaves",
                "lavender",
                "ice water"
              ],
              "ingredients_substituted": 1,
              "ingredients_removed": 0,
              "ingredients_kept": 2,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 3,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 217.41,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "vegan",
            "dairy free",
            "gluten free",
            "vegetarian"
          ],
          "is_vegetarian": true,
          "is_vegan": true,
          "is_gluten_free": true,
          "is_dairy_free": true,
          "cultura": "American",
          "estilo_cocina": "Moderno"
        },
        "similarity_features": {
          "total_ingredients_count": 23,
          "complexity_score": 50.0,
          "health_factor": 75.0,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_009",
      "description": "Restriction Test: Complex multi-restriction (vegan+nut-free+soy-free)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.09250664710998535,
      "iterations": 1,
      "final_menu": {
        "menu_id": 2,
        "menu_name": "Menu 2: Simple Squash Salad",
        "description": "Complete menu featuring Simple Squash Salad as main course",
        "courses": {
          "starter": {
            "recipe_id": 650871,
            "title": "Maple & Curry Acorn Squash",
            "servings": 3,
            "price_per_serving": 57.52,
            "ready_in_minutes": 0,
            "ingredients": [
              "acorn squash",
              "curry powder",
              "maple syrup",
              "olive oil",
              "salt"
            ],
            "restrictions": [
              "soy free",
              "dairy free",
              "vegetarian",
              "vegan",
              "nut free",
              "gluten free"
            ],
            "instructions": "<ol><li>Preheat oven to 400 F. Line a baking sheet with parchment paper or a silicone mat.</li><li>Rinse the outside of the acorn squash and then chop it in half. Seed the squash and chop off the stem. Next, slice it into one-inch wedges. I like use the natural grooves on the squash as a guide for thickness.</li><li>Place the sliced acorn squash in a medium-sized bowl. Add the rest of the ingredients to the bowl and stir until everything is well incorporated.</li><li>Lay the acorn squash in a single layer on top of the lined baking sheet, cut side down.</li><li>Bake for about 15 minutes. Flip the acorn squash slices to the other side so that both sides will be browned equally.</li><li>Bake the squash for another 10 to 15 minutes or until the pieces can be easily pierced with a fork.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "400 F",
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "line",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [
                  "parchment paper",
                  "silicone mat"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "rinse",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "seed",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "slice",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "place",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "curry powder",
                  "maple syrup",
                  "olive oil",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "stir",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "lay",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "15 minutes"
              },
              {
                "order": 5,
                "preparation_action": "flip",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "10 to 15 minutes"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "acorn squash",
                "curry powder",
                "maple syrup",
                "olive oil",
                "salt"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 660146,
            "title": "Simple Squash Salad",
            "servings": 6,
            "price_per_serving": 57.39,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "pepper",
              "parsley",
              "garlic",
              "garlic powder",
              "capers plus 2 tablespoons caper juice",
              "lemon",
              "onion",
              "oregano",
              "pepper flakes",
              "salt",
              "sugar",
              "vinegar",
              "zucchini"
            ],
            "restrictions": [
              "soy free",
              "dairy free",
              "vegetarian",
              "vegan",
              "nut free",
              "gluten free"
            ],
            "instructions": "<ol><li>Combine all of the ingredients the salad ingredients in a bowl.</li><li>Combine all of the dressing ingredients in a cup and stir, adjust the ingredients to taste. </li><li> Pour this over the salad and toss. </li><li> Let the salad sit in the refrigerator for a few hours before serving.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "pepper",
                  "parsley",
                  "garlic",
                  "garlic powder",
                  "capers",
                  "caper juice",
                  "lemon",
                  "onion",
                  "oregano",
                  "pepper flakes",
                  "salt",
                  "sugar",
                  "vinegar",
                  "zucchini"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [
                  "cup"
                ],
                "ingredients": [
                  "dressing ingredients"
                ],
                "tools": [
                  "stir"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "pour",
                "where": [],
                "ingredients": [
                  "dressing"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "toss",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "a few hours"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "bell pepper",
                "pepper",
                "parsley",
                "garlic",
                "garlic powder",
                "capers plus 2 tablespoons caper juice",
                "lemon",
                "onion",
                "oregano",
                "pepper flakes",
                "salt",
                "sugar",
                "vinegar",
                "zucchini"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 665330,
            "title": "Wild Blackberry Sorbet With Garden Mint & Lavender",
            "servings": 4,
            "price_per_serving": 102.5,
            "ready_in_minutes": 0,
            "ingredients": [
              "blackberries",
              "sugar",
              "water",
              "mint leaves",
              "chives and dill",
              "ice water"
            ],
            "restrictions": [
              "soy free",
              "dairy free",
              "vegetarian",
              "vegan",
              "nut free",
              "gluten free"
            ],
            "instructions": "Lay the clean, drained berries in a single layer on a cookie sheet and place in the freezer until frozen through. It is best to do both this and the next step the day or night before you plan to make the sorbet - just make sure you leave enough time for everything to freeze.\nMake the herb-infused simple syrup by combining the water and sugar in a small heavy-bottomed saucepan and heat over a medium flame until it comes to a boil. Turn it off and let cool completely.\nStrain out the mint leaves and lavender and pour the cooled syrup into an ice cube tray - should make roughly 4 syrup cubes. Place the tray in the freezer until syrup is frozen (the cubes may remain a little mushy as a result of all the sugar.)\nOnce the berries and herb-infused syrup cubes have frozen, you can make the sorbet. Place the frozen berries and syrup cubes in the bowl of a cuisinart or blender and add a few teaspoons of ice water to aid in blending. Continue to process or blend, adding small amounts of the ice water as needed, until smooth.\nServe, topped with a sprig of mint leaves and/or lavender.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "lay",
                "where": [
                  "cookie sheet"
                ],
                "ingredients": [
                  "berries"
                ],
                "tools": [],
                "temperature": null,
                "time": "until frozen through"
              },
              {
                "order": 2,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "water",
                  "sugar"
                ],
                "tools": [
                  "saucepan"
                ],
                "temperature": "medium",
                "time": "until it comes to a boil"
              },
              {
                "order": 3,
                "preparation_action": "turn off and let cool",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "completely"
              },
              {
                "order": 4,
                "preparation_action": "strain and pour",
                "where": [
                  "ice cube tray"
                ],
                "ingredients": [
                  "mint leaves",
                  "lavender",
                  "syrup"
                ],
                "tools": [],
                "temperature": null,
                "time": "until syrup is frozen"
              },
              {
                "order": 5,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "berries",
                  "syrup cubes",
                  "ice water"
                ],
                "tools": [
                  "cuisinart",
                  "blender"
                ],
                "temperature": null,
                "time": "until smooth"
              },
              {
                "order": 6,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "blackberries",
                "sugar",
                "water",
                "mint leaves",
                "chives and dill",
                "ice water"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 217.41,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "soy free",
            "dairy free",
            "vegetarian",
            "vegan",
            "nut free",
            "gluten free"
          ],
          "is_vegetarian": true,
          "is_vegan": true,
          "is_gluten_free": true,
          "is_dairy_free": true,
          "cultura": "American",
          "estilo_cocina": "Moderno"
        },
        "similarity_features": {
          "total_ingredients_count": 23,
          "complexity_score": 50.0,
          "health_factor": 75.0,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_010",
      "description": "Adaptation Test: Restriction requiring ingredient removal (no substitute)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.10030245780944824,
      "iterations": 1,
      "final_menu": {
        "menu_id": 1,
        "menu_name": "Menu 1: Corn Salsa",
        "description": "Complete menu featuring Corn Salsa as main course",
        "courses": {
          "starter": {
            "recipe_id": 640062,
            "title": "Corn Avocado Salsa",
            "servings": 2,
            "price_per_serving": 130.73,
            "ready_in_minutes": 0,
            "ingredients": [
              "avocado",
              "balsamic vinegar",
              "cumin",
              "corn",
              "garlic",
              "bell pepper"
            ],
            "restrictions": [
              "shellfish free",
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free"
            ],
            "instructions": "<ol><li>Preheat oven to 375 degrees.</li><li>Spread corn flat on a baking sheet.</li><li>Spray lightly with olive oil spray.</li><li>Roast corn in the oven for about 8-10 minutes. (Be careful not to brown too much or burn.)</li><li>Remove from heat and allow to cool.</li><li>Finely chop red pepper and garlic and mix in a bowl.</li><li>Peel and coarsely chop avocado and add to bowl.</li><li>Add cooled corn.</li><li>Mix in cumin and vinegar and blend well.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "375 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "spray",
                "where": [],
                "ingredients": [],
                "tools": [
                  "olive oil spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "roast",
                "where": [
                  "oven"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": "8-10 minutes"
              },
              {
                "order": 5,
                "preparation_action": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "allow",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "red pepper",
                  "garlic"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "peel",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "cumin",
                  "vinegar"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "blend",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "avocado",
                "balsamic vinegar",
                "cumin",
                "corn",
                "garlic",
                "bell pepper"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 640104,
            "title": "Corn Salsa",
            "servings": 4,
            "price_per_serving": 150.92,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "celery",
              "ears of corn - boil and from the cob",
              "basil",
              "garlic",
              "jalapeño",
              "onion",
              "salt",
              "sugar",
              "pickle",
              "vine tomato",
              "vinegar"
            ],
            "restrictions": [
              "shellfish free",
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free"
            ],
            "instructions": "<ol><li>Combine all of the above ingredients in a bowl.</li><li>Combine the ingredients for the dressing and add to the salsa.</li><li>Serve chilled.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "celery",
                  "ears of corn",
                  "basil",
                  "garlic",
                  "jalapeño",
                  "onion",
                  "salt",
                  "sugar",
                  "pickle",
                  "vine tomato"
                ],
                "tools": [
                  "bowl"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [],
                "ingredients": [
                  "vinegar",
                  "salsa"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "chilled",
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "bell pepper",
                "celery",
                "ears of corn - boil and from the cob",
                "basil",
                "garlic",
                "jalapeño",
                "onion",
                "salt",
                "sugar",
                "pickle",
                "vine tomato",
                "vinegar"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 655202,
            "title": "Peanut Brittle",
            "servings": 4,
            "price_per_serving": 107.1,
            "ready_in_minutes": 0,
            "ingredients": [
              "butter",
              "soda",
              "coconut",
              "corn syrup",
              "peanuts",
              "salt",
              "sugar",
              "water"
            ],
            "restrictions": [
              "shellfish free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Pour sugar, corn syrup and water into saucepan. Cook, stirring only until sugar is dissolved. Continue cooking until sugar begins to turn light brown (300 degrees) by candy thermometer. Remove from heat. Add salt, soda, butter and stir as little as possible, only to mix well. Stir in peanuts and coconut.Spread on a greased sheet of waxed paper set on top of a baking sheet and let the mixture cool and harden.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "pour",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cook",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [
                  "candy thermometer"
                ],
                "temperature": "300 degrees",
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "peanuts",
                  "coconut"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "cool and harden"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "butter",
                "soda",
                "coconut",
                "corn syrup",
                "peanuts",
                "salt",
                "sugar",
                "water"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 388.75,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "shellfish free",
            "gluten free",
            "vegetarian"
          ],
          "is_vegetarian": true,
          "is_vegan": false,
          "is_gluten_free": true,
          "is_dairy_free": false,
          "cultura": "American",
          "estilo_cocina": "Tradicional"
        },
        "similarity_features": {
          "total_ingredients_count": 22,
          "complexity_score": 52.0,
          "health_factor": 61.7,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_011",
      "description": "Restriction Test: Single restriction kosher",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.10776114463806152,
      "iterations": 1,
      "final_menu": {
        "menu_id": 2,
        "menu_name": "Menu 2: Simple Squash Salad",
        "description": "Complete menu featuring Simple Squash Salad as main course",
        "courses": {
          "starter": {
            "recipe_id": 650871,
            "title": "Maple & Curry Acorn Squash",
            "servings": 3,
            "price_per_serving": 57.52,
            "ready_in_minutes": 0,
            "ingredients": [
              "acorn squash",
              "curry powder",
              "maple syrup",
              "olive oil",
              "salt"
            ],
            "restrictions": [
              "kosher",
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free"
            ],
            "instructions": "<ol><li>Preheat oven to 400 F. Line a baking sheet with parchment paper or a silicone mat.</li><li>Rinse the outside of the acorn squash and then chop it in half. Seed the squash and chop off the stem. Next, slice it into one-inch wedges. I like use the natural grooves on the squash as a guide for thickness.</li><li>Place the sliced acorn squash in a medium-sized bowl. Add the rest of the ingredients to the bowl and stir until everything is well incorporated.</li><li>Lay the acorn squash in a single layer on top of the lined baking sheet, cut side down.</li><li>Bake for about 15 minutes. Flip the acorn squash slices to the other side so that both sides will be browned equally.</li><li>Bake the squash for another 10 to 15 minutes or until the pieces can be easily pierced with a fork.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "400 F",
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "line",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [
                  "parchment paper",
                  "silicone mat"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "rinse",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "seed",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "slice",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "place",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "curry powder",
                  "maple syrup",
                  "olive oil",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "stir",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "lay",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "15 minutes"
              },
              {
                "order": 5,
                "preparation_action": "flip",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "10 to 15 minutes"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "acorn squash",
                "curry powder",
                "maple syrup",
                "olive oil",
                "salt"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 660146,
            "title": "Simple Squash Salad",
            "servings": 6,
            "price_per_serving": 57.39,
            "ready_in_minutes": 0,
            "ingredients": [
              "clove garlic",
              "pepper",
              "parsley",
              "garlic",
              "clove garlic",
              "capers plus caper juice",
              "lemon",
              "onion",
              "oregano",
              "pepper flakes",
              "salt",
              "sugar",
              "vinegar",
              "zucchini"
            ],
            "restrictions": [
              "kosher",
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free"
            ],
            "instructions": "<ol><li>Combine all of the ingredients the salad ingredients in a bowl.</li><li>Combine all of the dressing ingredients in a cup and stir, adjust the ingredients to taste. </li><li> Pour this over the salad and toss. </li><li> Let the salad sit in the refrigerator for a few hours before serving.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "pepper",
                  "parsley",
                  "garlic",
                  "garlic powder",
                  "capers",
                  "caper juice",
                  "lemon",
                  "onion",
                  "oregano",
                  "pepper flakes",
                  "salt",
                  "sugar",
                  "vinegar",
                  "zucchini"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [
                  "cup"
                ],
                "ingredients": [
                  "dressing ingredients"
                ],
                "tools": [
                  "stir"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "pour",
                "where": [],
                "ingredients": [
                  "dressing"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "toss",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "a few hours"
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "thumb sized piece of ginger",
                  "substitute": "clove garlic",
                  "reason": [
                    "no pertenece a cultura 'mediterranean'",
                    "no pertenece a cultura 'mediterranean'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 84 candidatos"
                  ],
                  "candidates_found": 84,
                  "action": "substituted"
                },
                {
                  "original": "thumb sized piece of ginger",
                  "substitute": "clove garlic",
                  "reason": [
                    "no pertenece a cultura 'mediterranean'",
                    "no pertenece a cultura 'mediterranean'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 84 candidatos"
                  ],
                  "candidates_found": 84,
                  "action": "substituted"
                },
                {
                  "original": "pepper flakes",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'mediterranean'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                }
              ],
              "original_ingredients": [
                "thumb sized piece of ginger",
                "pepper",
                "parsley",
                "garlic",
                "thumb sized piece of ginger",
                "capers plus caper juice",
                "lemon",
                "onion",
                "oregano",
                "pepper flakes",
                "salt",
                "sugar",
                "vinegar",
                "zucchini"
              ],
              "ingredients_substituted": 2,
              "ingredients_removed": 0,
              "ingredients_kept": 1,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 3,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 665330,
            "title": "Wild Blackberry Sorbet With Garden Mint & Lavender",
            "servings": 4,
            "price_per_serving": 102.5,
            "ready_in_minutes": 0,
            "ingredients": [
              "blackberries",
              "sugar",
              "water",
              "mint leaves",
              "old bay",
              "ice water"
            ],
            "restrictions": [
              "kosher",
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free"
            ],
            "instructions": "Lay the clean, drained berries in a single layer on a cookie sheet and place in the freezer until frozen through. It is best to do both this and the next step the day or night before you plan to make the sorbet - just make sure you leave enough time for everything to freeze.\nMake the herb-infused simple syrup by combining the water and sugar in a small heavy-bottomed saucepan and heat over a medium flame until it comes to a boil. Turn it off and let cool completely.\nStrain out the mint leaves and lavender and pour the cooled syrup into an ice cube tray - should make roughly 4 syrup cubes. Place the tray in the freezer until syrup is frozen (the cubes may remain a little mushy as a result of all the sugar.)\nOnce the berries and herb-infused syrup cubes have frozen, you can make the sorbet. Place the frozen berries and syrup cubes in the bowl of a cuisinart or blender and add a few teaspoons of ice water to aid in blending. Continue to process or blend, adding small amounts of the ice water as needed, until smooth.\nServe, topped with a sprig of mint leaves and/or lavender.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "lay",
                "where": [
                  "cookie sheet"
                ],
                "ingredients": [
                  "berries"
                ],
                "tools": [],
                "temperature": null,
                "time": "until frozen through"
              },
              {
                "order": 2,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "water",
                  "sugar"
                ],
                "tools": [
                  "saucepan"
                ],
                "temperature": "medium",
                "time": "until it comes to a boil"
              },
              {
                "order": 3,
                "preparation_action": "turn off and let cool",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "completely"
              },
              {
                "order": 4,
                "preparation_action": "strain and pour",
                "where": [
                  "ice cube tray"
                ],
                "ingredients": [
                  "mint leaves",
                  "lavender",
                  "syrup"
                ],
                "tools": [],
                "temperature": null,
                "time": "until syrup is frozen"
              },
              {
                "order": 5,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "berries",
                  "syrup cubes",
                  "ice water"
                ],
                "tools": [
                  "cuisinart",
                  "blender"
                ],
                "temperature": null,
                "time": "until smooth"
              },
              {
                "order": 6,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "blackberries",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'mediterranean'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "mint leaves",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'mediterranean'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "chives and dill",
                  "substitute": "old bay",
                  "reason": [
                    "no pertenece a cultura 'mediterranean'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 22 candidatos"
                  ],
                  "candidates_found": 22,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "blackberries",
                "sugar",
                "water",
                "mint leaves",
                "chives and dill",
                "ice water"
              ],
              "ingredients_substituted": 1,
              "ingredients_removed": 0,
              "ingredients_kept": 2,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 3,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 217.41,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "kosher",
            "dairy free",
            "vegetarian",
            "vegan",
            "gluten free"
          ],
          "is_vegetarian": true,
          "is_vegan": true,
          "is_gluten_free": true,
          "is_dairy_free": true,
          "cultura": "American",
          "estilo_cocina": "Moderno"
        },
        "similarity_features": {
          "total_ingredients_count": 23,
          "complexity_score": 50.0,
          "health_factor": 75.0,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_012",
      "description": "Compliance Test: Case already meets all requirements (no adaptation needed)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.09994125366210938,
      "iterations": 1,
      "final_menu": {
        "menu_id": 1,
        "menu_name": "Menu 1: Corn Salsa",
        "description": "Complete menu featuring Corn Salsa as main course",
        "courses": {
          "starter": {
            "recipe_id": 640062,
            "title": "Corn Avocado Salsa",
            "servings": 2,
            "price_per_serving": 130.73,
            "ready_in_minutes": 0,
            "ingredients": [
              "avocado",
              "balsamic vinegar",
              "cumin",
              "corn",
              "garlic",
              "bell pepper"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Preheat oven to 375 degrees.</li><li>Spread corn flat on a baking sheet.</li><li>Spray lightly with olive oil spray.</li><li>Roast corn in the oven for about 8-10 minutes. (Be careful not to brown too much or burn.)</li><li>Remove from heat and allow to cool.</li><li>Finely chop red pepper and garlic and mix in a bowl.</li><li>Peel and coarsely chop avocado and add to bowl.</li><li>Add cooled corn.</li><li>Mix in cumin and vinegar and blend well.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "375 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "spray",
                "where": [],
                "ingredients": [],
                "tools": [
                  "olive oil spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "roast",
                "where": [
                  "oven"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": "8-10 minutes"
              },
              {
                "order": 5,
                "preparation_action": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "allow",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "red pepper",
                  "garlic"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "peel",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "cumin",
                  "vinegar"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "blend",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          },
          "main": {
            "recipe_id": 640104,
            "title": "Corn Salsa",
            "servings": 4,
            "price_per_serving": 150.92,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "celery",
              "ears of corn - boil and from the cob",
              "basil",
              "garlic",
              "jalapeño",
              "onion",
              "salt",
              "sugar",
              "pickle",
              "vine tomato",
              "vinegar"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Combine all of the above ingredients in a bowl.</li><li>Combine the ingredients for the dressing and add to the salsa.</li><li>Serve chilled.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "celery",
                  "ears of corn",
                  "basil",
                  "garlic",
                  "jalapeño",
                  "onion",
                  "salt",
                  "sugar",
                  "pickle",
                  "vine tomato"
                ],
                "tools": [
                  "bowl"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [],
                "ingredients": [
                  "vinegar",
                  "salsa"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "chilled",
                "time": null
              }
            ]
          },
          "dessert": {
            "recipe_id": 655202,
            "title": "Peanut Brittle",
            "servings": 4,
            "price_per_serving": 107.1,
            "ready_in_minutes": 0,
            "ingredients": [
              "butter",
              "soda",
              "coconut",
              "corn syrup",
              "peanuts",
              "salt",
              "sugar",
              "water"
            ],
            "restrictions": [
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Pour sugar, corn syrup and water into saucepan. Cook, stirring only until sugar is dissolved. Continue cooking until sugar begins to turn light brown (300 degrees) by candy thermometer. Remove from heat. Add salt, soda, butter and stir as little as possible, only to mix well. Stir in peanuts and coconut.Spread on a greased sheet of waxed paper set on top of a baking sheet and let the mixture cool and harden.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "pour",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cook",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [
                  "candy thermometer"
                ],
                "temperature": "300 degrees",
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "peanuts",
                  "coconut"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "cool and harden"
              }
            ]
          }
        },
        "features": {
          "total_price_per_serving": 388.75,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "vegetarian",
            "gluten free"
          ],
          "is_vegetarian": true,
          "is_vegan": false,
          "is_gluten_free": true,
          "is_dairy_free": false,
          "cultura": "American",
          "estilo_cocina": "Tradicional"
        },
        "similarity_features": {
          "total_ingredients_count": 22,
          "complexity_score": 52.0,
          "health_factor": 61.7,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_013",
      "description": "Compliance Test: Exact match on all criteria",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.09971261024475098,
      "iterations": 1,
      "final_menu": {
        "menu_id": 1,
        "menu_name": "Menu 1: Corn Salsa",
        "description": "Complete menu featuring Corn Salsa as main course",
        "courses": {
          "starter": {
            "recipe_id": 640062,
            "title": "Corn Avocado Salsa",
            "servings": 2,
            "price_per_serving": 130.73,
            "ready_in_minutes": 0,
            "ingredients": [
              "avocado",
              "balsamic vinegar",
              "cumin",
              "corn",
              "garlic",
              "bell pepper"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Preheat oven to 375 degrees.</li><li>Spread corn flat on a baking sheet.</li><li>Spray lightly with olive oil spray.</li><li>Roast corn in the oven for about 8-10 minutes. (Be careful not to brown too much or burn.)</li><li>Remove from heat and allow to cool.</li><li>Finely chop red pepper and garlic and mix in a bowl.</li><li>Peel and coarsely chop avocado and add to bowl.</li><li>Add cooled corn.</li><li>Mix in cumin and vinegar and blend well.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "375 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "spray",
                "where": [],
                "ingredients": [],
                "tools": [
                  "olive oil spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "roast",
                "where": [
                  "oven"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": "8-10 minutes"
              },
              {
                "order": 5,
                "preparation_action": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "allow",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "red pepper",
                  "garlic"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "peel",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "cumin",
                  "vinegar"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "blend",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          },
          "main": {
            "recipe_id": 640104,
            "title": "Corn Salsa",
            "servings": 4,
            "price_per_serving": 150.92,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "celery",
              "ears of corn - boil and from the cob",
              "basil",
              "garlic",
              "jalapeño",
              "onion",
              "salt",
              "sugar",
              "pickle",
              "vine tomato",
              "vinegar"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Combine all of the above ingredients in a bowl.</li><li>Combine the ingredients for the dressing and add to the salsa.</li><li>Serve chilled.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "celery",
                  "ears of corn",
                  "basil",
                  "garlic",
                  "jalapeño",
                  "onion",
                  "salt",
                  "sugar",
                  "pickle",
                  "vine tomato"
                ],
                "tools": [
                  "bowl"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [],
                "ingredients": [
                  "vinegar",
                  "salsa"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "chilled",
                "time": null
              }
            ]
          },
          "dessert": {
            "recipe_id": 655202,
            "title": "Peanut Brittle",
            "servings": 4,
            "price_per_serving": 107.1,
            "ready_in_minutes": 0,
            "ingredients": [
              "butter",
              "soda",
              "coconut",
              "corn syrup",
              "peanuts",
              "salt",
              "sugar",
              "water"
            ],
            "restrictions": [
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Pour sugar, corn syrup and water into saucepan. Cook, stirring only until sugar is dissolved. Continue cooking until sugar begins to turn light brown (300 degrees) by candy thermometer. Remove from heat. Add salt, soda, butter and stir as little as possible, only to mix well. Stir in peanuts and coconut.Spread on a greased sheet of waxed paper set on top of a baking sheet and let the mixture cool and harden.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "pour",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cook",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [
                  "candy thermometer"
                ],
                "temperature": "300 degrees",
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "peanuts",
                  "coconut"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "cool and harden"
              }
            ]
          }
        },
        "features": {
          "total_price_per_serving": 388.75,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "vegetarian",
            "gluten free"
          ],
          "is_vegetarian": true,
          "is_vegan": false,
          "is_gluten_free": true,
          "is_dairy_free": false,
          "cultura": "American",
          "estilo_cocina": "Tradicional"
        },
        "similarity_features": {
          "total_ingredients_count": 22,
          "complexity_score": 52.0,
          "health_factor": 61.7,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_014",
      "description": "Culture Test: Chinese cuisine (East Asian ontology mapping)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.10094022750854492,
      "iterations": 1,
      "final_menu": {
        "menu_id": 1,
        "menu_name": "Menu 1: Corn Salsa",
        "description": "Complete menu featuring Corn Salsa as main course",
        "courses": {
          "starter": {
            "recipe_id": 640062,
            "title": "Corn Avocado Salsa",
            "servings": 2,
            "price_per_serving": 130.73,
            "ready_in_minutes": 0,
            "ingredients": [
              "navel orange",
              "rice wine vinegar",
              "shallotsred onion",
              "corn",
              "garlic",
              "bell pepper"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Preheat oven to 375 degrees.</li><li>Spread corn flat on a baking sheet.</li><li>Spray lightly with olive oil spray.</li><li>Roast corn in the oven for about 8-10 minutes. (Be careful not to brown too much or burn.)</li><li>Remove from heat and allow to cool.</li><li>Finely chop red pepper and garlic and mix in a bowl.</li><li>Peel and coarsely chop avocado and add to bowl.</li><li>Add cooled corn.</li><li>Mix in cumin and vinegar and blend well.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "375 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "spray",
                "where": [],
                "ingredients": [],
                "tools": [
                  "olive oil spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "roast",
                "where": [
                  "oven"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": "8-10 minutes"
              },
              {
                "order": 5,
                "preparation_action": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "allow",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "red pepper",
                  "garlic"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "peel",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "cumin",
                  "vinegar"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "blend",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "avocado",
                  "substitute": "navel orange",
                  "reason": [
                    "no pertenece a cultura 'chinese'"
                  ],
                  "search_attempts": [
                    "ontología (category): 33 candidatos"
                  ],
                  "candidates_found": 33,
                  "action": "substituted"
                },
                {
                  "original": "balsamic vinegar",
                  "substitute": "rice wine vinegar",
                  "reason": [
                    "no pertenece a cultura 'chinese'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 9 candidatos"
                  ],
                  "candidates_found": 9,
                  "action": "substituted"
                },
                {
                  "original": "cumin",
                  "substitute": "shallotsred onion",
                  "reason": [
                    "no pertenece a cultura 'chinese'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 84 candidatos"
                  ],
                  "candidates_found": 84,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "avocado",
                "balsamic vinegar",
                "cumin",
                "corn",
                "garlic",
                "bell pepper"
              ],
              "ingredients_substituted": 3,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 4,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 1,
                "pending_ingredients": [
                  "corn"
                ],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 640104,
            "title": "Corn Salsa",
            "servings": 4,
            "price_per_serving": 150.92,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "shallot",
              "ears of corn - boil and from the cob",
              "fresh chive",
              "garlic",
              "jalapeño",
              "onion",
              "salt",
              "sugar",
              "pickle",
              "vine tomato",
              "vinegar"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Combine all of the above ingredients in a bowl.</li><li>Combine the ingredients for the dressing and add to the salsa.</li><li>Serve chilled.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "celery",
                  "ears of corn",
                  "basil",
                  "garlic",
                  "jalapeño",
                  "onion",
                  "salt",
                  "sugar",
                  "pickle",
                  "vine tomato"
                ],
                "tools": [
                  "bowl"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [],
                "ingredients": [
                  "vinegar",
                  "salsa"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "chilled",
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "celery",
                  "substitute": "shallot",
                  "reason": [
                    "no pertenece a cultura 'chinese'"
                  ],
                  "search_attempts": [
                    "ontología (category): 80 candidatos"
                  ],
                  "candidates_found": 80,
                  "action": "substituted"
                },
                {
                  "original": "ears of corn - boil and from the cob",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'chinese'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "basil",
                  "substitute": "fresh chive",
                  "reason": [
                    "no pertenece a cultura 'chinese'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 23 candidatos"
                  ],
                  "candidates_found": 23,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "bell pepper",
                "celery",
                "ears of corn - boil and from the cob",
                "basil",
                "garlic",
                "jalapeño",
                "onion",
                "salt",
                "sugar",
                "pickle",
                "vine tomato",
                "vinegar"
              ],
              "ingredients_substituted": 2,
              "ingredients_removed": 0,
              "ingredients_kept": 1,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 7,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 4,
                "pending_ingredients": [
                  "jalapeño",
                  "pickle",
                  "vine tomato",
                  "vinegar"
                ],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 655202,
            "title": "Peanut Brittle",
            "servings": 4,
            "price_per_serving": 107.1,
            "ready_in_minutes": 0,
            "ingredients": [
              "butter",
              "carbonated water",
              "apple",
              "corn syrup",
              "sunflower seed butter",
              "salt",
              "sugar",
              "water"
            ],
            "restrictions": [
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Pour sugar, corn syrup and water into saucepan. Cook, stirring only until sugar is dissolved. Continue cooking until sugar begins to turn light brown (300 degrees) by candy thermometer. Remove from heat. Add salt, soda, butter and stir as little as possible, only to mix well. Stir in peanuts and coconut.Spread on a greased sheet of waxed paper set on top of a baking sheet and let the mixture cool and harden.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "pour",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cook",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [
                  "candy thermometer"
                ],
                "temperature": "300 degrees",
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "peanuts",
                  "coconut"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "cool and harden"
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "soda",
                  "substitute": "carbonated water",
                  "reason": [
                    "no pertenece a cultura 'chinese'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 3 candidatos"
                  ],
                  "candidates_found": 3,
                  "action": "substituted"
                },
                {
                  "original": "coconut",
                  "substitute": "apple",
                  "reason": [
                    "no pertenece a cultura 'chinese'"
                  ],
                  "search_attempts": [
                    "ontología (category): 33 candidatos"
                  ],
                  "candidates_found": 33,
                  "action": "substituted"
                },
                {
                  "original": "peanuts",
                  "substitute": "sunflower seed butter",
                  "reason": [
                    "no pertenece a cultura 'chinese'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 2 candidatos"
                  ],
                  "candidates_found": 0,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "butter",
                "soda",
                "coconut",
                "corn syrup",
                "peanuts",
                "salt",
                "sugar",
                "water"
              ],
              "ingredients_substituted": 3,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 3,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 388.75,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "gluten free",
            "vegetarian"
          ],
          "is_vegetarian": true,
          "is_vegan": false,
          "is_gluten_free": true,
          "is_dairy_free": false,
          "cultura": "American",
          "estilo_cocina": "Tradicional"
        },
        "similarity_features": {
          "total_ingredients_count": 22,
          "complexity_score": 52.0,
          "health_factor": 61.7,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_015",
      "description": "Budget Edge Case: Zero budget and min > max",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.1082460880279541,
      "iterations": 1,
      "final_menu": {
        "menu_id": 3,
        "menu_name": "Menu 3: Zucchini Ribbon Caper Salad",
        "description": "Complete menu featuring Zucchini Ribbon Caper Salad as main course",
        "courses": {
          "starter": {
            "recipe_id": 641057,
            "title": "Curried Butternut Squash and Apple Soup",
            "servings": 1,
            "price_per_serving": 141.44,
            "ready_in_minutes": 0,
            "ingredients": [
              "cauliflower",
              "butternut squash",
              "apple",
              "water",
              "braggs liquid aminos",
              "curry powder",
              "ginger powder",
              "a squirt sriracha",
              "block lite tofu"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "Get ready two small saucepans.\nIn one have together 1/2 of the squash and 1/2 of the apple  bring to a simmer, and simmer until just tender when pierced with a fork.\nIn the other, add in the rest of the vegetables along with 1 cup of water  bring this to a rolling boil, reduce to a simmer, and simmer until very very tender. When very tender, remove the vegetables from the heat, and blend these vegetables together (without draining) with the Braggs, spices, sriracha and the additional 1/2 cup water.\nMix the blended part of the soup with the simmered squash and apples. Mix in the cubed tofu, gently re-heat and serve.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "get ready",
                "where": [
                  "kitchen"
                ],
                "ingredients": [],
                "tools": [
                  "saucepans"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "have",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "butternut squash",
                  "apple"
                ],
                "tools": [
                  "fork"
                ],
                "temperature": "simmer",
                "time": "until just tender"
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "cauliflower",
                  "water"
                ],
                "tools": [],
                "temperature": "rolling boil",
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "bring",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "rolling boil",
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "reduce",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "simmer",
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "simmer",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "simmer",
                "time": "until very tender"
              },
              {
                "order": 7,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "blend",
                "where": [
                  "blender"
                ],
                "ingredients": [
                  "cauliflower",
                  "Braggs liquid aminos",
                  "curry powder",
                  "ginger powder",
                  "sriracha",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "mix",
                "where": [
                  "kitchen"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "mix",
                "where": [
                  "kitchen"
                ],
                "ingredients": [
                  "butternut squash",
                  "apple"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "kitchen"
                ],
                "ingredients": [
                  "block lite tofu"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "re-heat",
                "where": [
                  "kitchen"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "serve",
                "where": [
                  "kitchen"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          },
          "main": {
            "recipe_id": 665777,
            "title": "Zucchini Ribbon Caper Salad",
            "servings": 3,
            "price_per_serving": 66.59,
            "ready_in_minutes": 0,
            "ingredients": [
              "capers",
              "garlic",
              "lemon zest",
              "olive oil",
              "salt and pepper",
              "tomato",
              "zucchini"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Toss the zucchini strips with the oil, lemon zest and juice, garlic, salt and pepper. Set aside for 30 minutes to marinate.</li><li>Divide between 2-3 plates and top with capers, tomato julienne. Drizzle any extra dressing over if desired. To garnish, sprinkle a pinch of dried parsley over.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "toss",
                "where": [
                  "aside"
                ],
                "ingredients": [
                  "zucchini",
                  "oil",
                  "lemon zest",
                  "garlic",
                  "salt",
                  "pepper"
                ],
                "tools": [],
                "temperature": null,
                "time": "30 minutes"
              },
              {
                "order": 2,
                "preparation_action": "divide",
                "where": [
                  "plates"
                ],
                "ingredients": [
                  "capers",
                  "tomato"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "top",
                "where": [
                  "plates"
                ],
                "ingredients": [
                  "capers",
                  "tomato"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "drizzle",
                "where": [
                  "plates"
                ],
                "ingredients": [
                  "dressing"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "garnish",
                "where": [
                  "plates"
                ],
                "ingredients": [
                  "parsley"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          },
          "dessert": {
            "recipe_id": 664474,
            "title": "Vegan Pumpkin Pie Butter Cups",
            "servings": 16,
            "price_per_serving": 272.35,
            "ready_in_minutes": 0,
            "ingredients": [
              "chocolate pie crust",
              "cocoa powder",
              "walnuts",
              "coconut",
              "medjool dates",
              "chocolate shell",
              "cocoa powder",
              "tbs coconut oil",
              "maple syrup",
              "pumpkin puree",
              "peanut butter",
              "maple syrup",
              "chia seeds",
              "pumpkin pie spice"
            ],
            "restrictions": [
              "dairy free"
            ],
            "instructions": "Line 16 muffin cups with paper or silicone liners. The butter cups are easier to take out if you use paper liners.\nIn a food processor, blend all of the chocolate crust ingredients together.\nDrop a tablespoon of the crust into each cup and flatten it at the bottom.\nIn a small bowl, mix the ingredients for the pumpkin filling together. Freeze it for 5-10 minutes.\nMix the chocolate shell ingredients together until it looks like chocolate sauce.\nRemove the pumpkin filling and drop -tablespoon dollops of the pie filling into each cup.\nPour about 2 teaspoons of chocolate sauce into each cup so that you could just about cover up the pumpkin filling.\nFreeze the cups for 30 minutes to an hour.\nStore in the refrigerator. The chocolate will turn gooey if you leave the cups out in room temperature for a long time.\nEnjoy!",
            "structured_instructions": [
              {
                "order": 1,
                "preparation": "line",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [
                  "paper liners",
                  "silicone liners"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation": "use",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation": "blend",
                "where": [
                  "food processor"
                ],
                "ingredients": [
                  "chocolate crust"
                ],
                "tools": [
                  "food processor"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation": "drop",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [
                  "crust"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation": "flatten",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation": "mix",
                "where": [
                  "small bowl"
                ],
                "ingredients": [
                  "pumpkin filling"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation": "freeze",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "5-10 minutes"
              },
              {
                "order": 8,
                "preparation": "mix",
                "where": [],
                "ingredients": [
                  "chocolate shell"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation": "drop",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [
                  "pie filling"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation": "pour",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [
                  "chocolate sauce"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation": "freeze",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "30 minutes to an hour"
              },
              {
                "order": 13,
                "preparation": "store",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 14,
                "preparation": "enjoy",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          }
        },
        "features": {
          "total_price_per_serving": 480.38,
          "price_category": "premium",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": false,
          "common_dietary_restrictions": [
            "dairy free"
          ],
          "is_vegetarian": false,
          "is_vegan": false,
          "is_gluten_free": false,
          "is_dairy_free": true,
          "cultura": "Mediterranean",
          "estilo_cocina": "Moderno/Vegano"
        },
        "similarity_features": {
          "total_ingredients_count": 28,
          "complexity_score": 60.0,
          "health_factor": 53.3,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_016",
      "description": "Retain Test: High usefulness case (many adaptations + novel + valid)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.10983586311340332,
      "iterations": 1,
      "final_menu": {
        "menu_id": 2,
        "menu_name": "Menu 2: Simple Squash Salad",
        "description": "Complete menu featuring Simple Squash Salad as main course",
        "courses": {
          "starter": {
            "recipe_id": 650871,
            "title": "Maple & Curry Acorn Squash",
            "servings": 3,
            "price_per_serving": 57.52,
            "ready_in_minutes": 0,
            "ingredients": [
              "baking potatoes recommended",
              "cocoa powder",
              "chocolate",
              "olive oil",
              "salt"
            ],
            "restrictions": [
              "soy free",
              "dairy free",
              "vegetarian",
              "vegan",
              "nut free",
              "gluten free"
            ],
            "instructions": "<ol><li>Preheat oven to 400 F. Line a baking sheet with parchment paper or a silicone mat.</li><li>Rinse the outside of the acorn squash and then chop it in half. Seed the squash and chop off the stem. Next, slice it into one-inch wedges. I like use the natural grooves on the squash as a guide for thickness.</li><li>Place the sliced acorn squash in a medium-sized bowl. Add the rest of the ingredients to the bowl and stir until everything is well incorporated.</li><li>Lay the acorn squash in a single layer on top of the lined baking sheet, cut side down.</li><li>Bake for about 15 minutes. Flip the acorn squash slices to the other side so that both sides will be browned equally.</li><li>Bake the squash for another 10 to 15 minutes or until the pieces can be easily pierced with a fork.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "400 F",
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "line",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [
                  "parchment paper",
                  "silicone mat"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "rinse",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "seed",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "slice",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "place",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "curry powder",
                  "maple syrup",
                  "olive oil",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "stir",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "lay",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "15 minutes"
              },
              {
                "order": 5,
                "preparation_action": "flip",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "10 to 15 minutes"
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "acorn squash",
                  "substitute": "baking potatoes recommended",
                  "reason": [
                    "no pertenece a cultura 'korean'"
                  ],
                  "search_attempts": [
                    "ontología (category): 18 candidatos"
                  ],
                  "candidates_found": 18,
                  "action": "substituted"
                },
                {
                  "original": "curry powder",
                  "substitute": "cocoa powder",
                  "reason": [
                    "no pertenece a cultura 'korean'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 12 candidatos"
                  ],
                  "candidates_found": 12,
                  "action": "substituted"
                },
                {
                  "original": "maple syrup",
                  "substitute": "chocolate",
                  "reason": [
                    "no pertenece a cultura 'korean'"
                  ],
                  "search_attempts": [
                    "ontología (category): 9 candidatos"
                  ],
                  "candidates_found": 9,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "acorn squash",
                "curry powder",
                "maple syrup",
                "olive oil",
                "salt"
              ],
              "ingredients_substituted": 3,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 3,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 660146,
            "title": "Simple Squash Salad",
            "servings": 6,
            "price_per_serving": 57.39,
            "ready_in_minutes": 0,
            "ingredients": [
              "clove garlic",
              "pepper",
              "basil shred",
              "garlic",
              "clove garlic",
              "capers plus 2 tablespoons caper juice",
              "lemon",
              "onion",
              "oregano",
              "pepper flakes",
              "salt",
              "sugar",
              "vinegar",
              "zucchini"
            ],
            "restrictions": [
              "soy free",
              "dairy free",
              "vegetarian",
              "vegan",
              "nut free",
              "gluten free"
            ],
            "instructions": "<ol><li>Combine all of the ingredients the salad ingredients in a bowl.</li><li>Combine all of the dressing ingredients in a cup and stir, adjust the ingredients to taste. </li><li> Pour this over the salad and toss. </li><li> Let the salad sit in the refrigerator for a few hours before serving.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "pepper",
                  "parsley",
                  "garlic",
                  "garlic powder",
                  "capers",
                  "caper juice",
                  "lemon",
                  "onion",
                  "oregano",
                  "pepper flakes",
                  "salt",
                  "sugar",
                  "vinegar",
                  "zucchini"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [
                  "cup"
                ],
                "ingredients": [
                  "dressing ingredients"
                ],
                "tools": [
                  "stir"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "pour",
                "where": [],
                "ingredients": [
                  "dressing"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "toss",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "a few hours"
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "bell pepper",
                  "substitute": "clove garlic",
                  "reason": [
                    "no pertenece a cultura 'korean'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 84 candidatos"
                  ],
                  "candidates_found": 84,
                  "action": "substituted"
                },
                {
                  "original": "parsley",
                  "substitute": "basil shred",
                  "reason": [
                    "no pertenece a cultura 'korean'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 23 candidatos"
                  ],
                  "candidates_found": 23,
                  "action": "substituted"
                },
                {
                  "original": "garlic powder",
                  "substitute": "clove garlic",
                  "reason": [
                    "no pertenece a cultura 'korean'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 84 candidatos"
                  ],
                  "candidates_found": 84,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "bell pepper",
                "pepper",
                "parsley",
                "garlic",
                "garlic powder",
                "capers plus 2 tablespoons caper juice",
                "lemon",
                "onion",
                "oregano",
                "pepper flakes",
                "salt",
                "sugar",
                "vinegar",
                "zucchini"
              ],
              "ingredients_substituted": 3,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 8,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 5,
                "pending_ingredients": [
                  "capers plus 2 tablespoons caper juice",
                  "lemon",
                  "oregano",
                  "pepper flakes",
                  "vinegar"
                ],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 665330,
            "title": "Wild Blackberry Sorbet With Garden Mint & Lavender",
            "servings": 4,
            "price_per_serving": 102.5,
            "ready_in_minutes": 0,
            "ingredients": [
              "blackberries",
              "sugar",
              "water",
              "mint leaves",
              "old bay",
              "ice water"
            ],
            "restrictions": [
              "soy free",
              "dairy free",
              "vegetarian",
              "vegan",
              "nut free",
              "gluten free"
            ],
            "instructions": "Lay the clean, drained berries in a single layer on a cookie sheet and place in the freezer until frozen through. It is best to do both this and the next step the day or night before you plan to make the sorbet - just make sure you leave enough time for everything to freeze.\nMake the herb-infused simple syrup by combining the water and sugar in a small heavy-bottomed saucepan and heat over a medium flame until it comes to a boil. Turn it off and let cool completely.\nStrain out the mint leaves and lavender and pour the cooled syrup into an ice cube tray - should make roughly 4 syrup cubes. Place the tray in the freezer until syrup is frozen (the cubes may remain a little mushy as a result of all the sugar.)\nOnce the berries and herb-infused syrup cubes have frozen, you can make the sorbet. Place the frozen berries and syrup cubes in the bowl of a cuisinart or blender and add a few teaspoons of ice water to aid in blending. Continue to process or blend, adding small amounts of the ice water as needed, until smooth.\nServe, topped with a sprig of mint leaves and/or lavender.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "lay",
                "where": [
                  "cookie sheet"
                ],
                "ingredients": [
                  "berries"
                ],
                "tools": [],
                "temperature": null,
                "time": "until frozen through"
              },
              {
                "order": 2,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "water",
                  "sugar"
                ],
                "tools": [
                  "saucepan"
                ],
                "temperature": "medium",
                "time": "until it comes to a boil"
              },
              {
                "order": 3,
                "preparation_action": "turn off and let cool",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "completely"
              },
              {
                "order": 4,
                "preparation_action": "strain and pour",
                "where": [
                  "ice cube tray"
                ],
                "ingredients": [
                  "mint leaves",
                  "lavender",
                  "syrup"
                ],
                "tools": [],
                "temperature": null,
                "time": "until syrup is frozen"
              },
              {
                "order": 5,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "berries",
                  "syrup cubes",
                  "ice water"
                ],
                "tools": [
                  "cuisinart",
                  "blender"
                ],
                "temperature": null,
                "time": "until smooth"
              },
              {
                "order": 6,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "blackberries",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'korean'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "mint leaves",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'korean'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "chives and dill",
                  "substitute": "old bay",
                  "reason": [
                    "no pertenece a cultura 'korean'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 22 candidatos"
                  ],
                  "candidates_found": 22,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "blackberries",
                "sugar",
                "water",
                "mint leaves",
                "chives and dill",
                "ice water"
              ],
              "ingredients_substituted": 1,
              "ingredients_removed": 0,
              "ingredients_kept": 2,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 4,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 1,
                "pending_ingredients": [
                  "ice water"
                ],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 217.41,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "soy free",
            "dairy free",
            "vegetarian",
            "vegan",
            "nut free",
            "gluten free"
          ],
          "is_vegetarian": true,
          "is_vegan": true,
          "is_gluten_free": true,
          "is_dairy_free": true,
          "cultura": "American",
          "estilo_cocina": "Moderno"
        },
        "similarity_features": {
          "total_ingredients_count": 23,
          "complexity_score": 50.0,
          "health_factor": 75.0,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_017",
      "description": "Retain Test: Low usefulness case (high similarity to existing)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.09891676902770996,
      "iterations": 1,
      "final_menu": {
        "menu_id": 1,
        "menu_name": "Menu 1: Corn Salsa",
        "description": "Complete menu featuring Corn Salsa as main course",
        "courses": {
          "starter": {
            "recipe_id": 640062,
            "title": "Corn Avocado Salsa",
            "servings": 2,
            "price_per_serving": 130.73,
            "ready_in_minutes": 0,
            "ingredients": [
              "avocado",
              "balsamic vinegar",
              "cumin",
              "corn",
              "garlic",
              "bell pepper"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Preheat oven to 375 degrees.</li><li>Spread corn flat on a baking sheet.</li><li>Spray lightly with olive oil spray.</li><li>Roast corn in the oven for about 8-10 minutes. (Be careful not to brown too much or burn.)</li><li>Remove from heat and allow to cool.</li><li>Finely chop red pepper and garlic and mix in a bowl.</li><li>Peel and coarsely chop avocado and add to bowl.</li><li>Add cooled corn.</li><li>Mix in cumin and vinegar and blend well.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "375 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "spray",
                "where": [],
                "ingredients": [],
                "tools": [
                  "olive oil spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "roast",
                "where": [
                  "oven"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": "8-10 minutes"
              },
              {
                "order": 5,
                "preparation_action": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "allow",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "red pepper",
                  "garlic"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "peel",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "cumin",
                  "vinegar"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "blend",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          },
          "main": {
            "recipe_id": 640104,
            "title": "Corn Salsa",
            "servings": 4,
            "price_per_serving": 150.92,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "celery",
              "ears of corn - boil and from the cob",
              "basil",
              "garlic",
              "jalapeño",
              "onion",
              "salt",
              "sugar",
              "pickle",
              "vine tomato",
              "vinegar"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Combine all of the above ingredients in a bowl.</li><li>Combine the ingredients for the dressing and add to the salsa.</li><li>Serve chilled.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "celery",
                  "ears of corn",
                  "basil",
                  "garlic",
                  "jalapeño",
                  "onion",
                  "salt",
                  "sugar",
                  "pickle",
                  "vine tomato"
                ],
                "tools": [
                  "bowl"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [],
                "ingredients": [
                  "vinegar",
                  "salsa"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "chilled",
                "time": null
              }
            ]
          },
          "dessert": {
            "recipe_id": 655202,
            "title": "Peanut Brittle",
            "servings": 4,
            "price_per_serving": 107.1,
            "ready_in_minutes": 0,
            "ingredients": [
              "butter",
              "soda",
              "coconut",
              "corn syrup",
              "peanuts",
              "salt",
              "sugar",
              "water"
            ],
            "restrictions": [
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Pour sugar, corn syrup and water into saucepan. Cook, stirring only until sugar is dissolved. Continue cooking until sugar begins to turn light brown (300 degrees) by candy thermometer. Remove from heat. Add salt, soda, butter and stir as little as possible, only to mix well. Stir in peanuts and coconut.Spread on a greased sheet of waxed paper set on top of a baking sheet and let the mixture cool and harden.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "pour",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cook",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [
                  "candy thermometer"
                ],
                "temperature": "300 degrees",
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "peanuts",
                  "coconut"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "cool and harden"
              }
            ]
          }
        },
        "features": {
          "total_price_per_serving": 388.75,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "vegetarian",
            "gluten free"
          ],
          "is_vegetarian": true,
          "is_vegan": false,
          "is_gluten_free": true,
          "is_dairy_free": false,
          "cultura": "American",
          "estilo_cocina": "Tradicional"
        },
        "similarity_features": {
          "total_ingredients_count": 22,
          "complexity_score": 52.0,
          "health_factor": 61.7,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_018",
      "description": "Iteration Test: Failed validation triggers revision (interactive=False)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.07913565635681152,
      "iterations": 1,
      "final_menu": {
        "menu_id": 2,
        "menu_name": "Menu 2: Simple Squash Salad",
        "description": "Complete menu featuring Simple Squash Salad as main course",
        "courses": {
          "starter": {
            "recipe_id": 650871,
            "title": "Maple & Curry Acorn Squash",
            "servings": 3,
            "price_per_serving": 57.52,
            "ready_in_minutes": 0,
            "ingredients": [
              "acorn squash",
              "curry powder",
              "maple syrup",
              "olive oil",
              "salt"
            ],
            "restrictions": [
              "kosher",
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free",
              "halal"
            ],
            "instructions": "<ol><li>Preheat oven to 400 F. Line a baking sheet with parchment paper or a silicone mat.</li><li>Rinse the outside of the acorn squash and then chop it in half. Seed the squash and chop off the stem. Next, slice it into one-inch wedges. I like use the natural grooves on the squash as a guide for thickness.</li><li>Place the sliced acorn squash in a medium-sized bowl. Add the rest of the ingredients to the bowl and stir until everything is well incorporated.</li><li>Lay the acorn squash in a single layer on top of the lined baking sheet, cut side down.</li><li>Bake for about 15 minutes. Flip the acorn squash slices to the other side so that both sides will be browned equally.</li><li>Bake the squash for another 10 to 15 minutes or until the pieces can be easily pierced with a fork.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "400 F",
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "line",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [
                  "parchment paper",
                  "silicone mat"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "rinse",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "seed",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "slice",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "place",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "curry powder",
                  "maple syrup",
                  "olive oil",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "stir",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "lay",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "15 minutes"
              },
              {
                "order": 5,
                "preparation_action": "flip",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "10 to 15 minutes"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "acorn squash",
                "curry powder",
                "maple syrup",
                "olive oil",
                "salt"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 660146,
            "title": "Simple Squash Salad",
            "servings": 6,
            "price_per_serving": 57.39,
            "ready_in_minutes": 0,
            "ingredients": [
              "clove garlic",
              "pepper",
              "parsley",
              "garlic",
              "clove garlic",
              "capers plus caper juice",
              "lemon",
              "onion",
              "oregano",
              "pepper flakes",
              "salt",
              "sugar",
              "vinegar",
              "zucchini"
            ],
            "restrictions": [
              "kosher",
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free",
              "halal"
            ],
            "instructions": "<ol><li>Combine all of the ingredients the salad ingredients in a bowl.</li><li>Combine all of the dressing ingredients in a cup and stir, adjust the ingredients to taste. </li><li> Pour this over the salad and toss. </li><li> Let the salad sit in the refrigerator for a few hours before serving.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "pepper",
                  "parsley",
                  "garlic",
                  "garlic powder",
                  "capers",
                  "caper juice",
                  "lemon",
                  "onion",
                  "oregano",
                  "pepper flakes",
                  "salt",
                  "sugar",
                  "vinegar",
                  "zucchini"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [
                  "cup"
                ],
                "ingredients": [
                  "dressing ingredients"
                ],
                "tools": [
                  "stir"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "pour",
                "where": [],
                "ingredients": [
                  "dressing"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "toss",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "a few hours"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "clove garlic",
                "pepper",
                "parsley",
                "garlic",
                "clove garlic",
                "capers plus caper juice",
                "lemon",
                "onion",
                "oregano",
                "pepper flakes",
                "salt",
                "sugar",
                "vinegar",
                "zucchini"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 665330,
            "title": "Wild Blackberry Sorbet With Garden Mint & Lavender",
            "servings": 4,
            "price_per_serving": 102.5,
            "ready_in_minutes": 0,
            "ingredients": [
              "blackberries",
              "sugar",
              "water",
              "mint leaves",
              "old bay",
              "ice water"
            ],
            "restrictions": [
              "kosher",
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free",
              "halal"
            ],
            "instructions": "Lay the clean, drained berries in a single layer on a cookie sheet and place in the freezer until frozen through. It is best to do both this and the next step the day or night before you plan to make the sorbet - just make sure you leave enough time for everything to freeze.\nMake the herb-infused simple syrup by combining the water and sugar in a small heavy-bottomed saucepan and heat over a medium flame until it comes to a boil. Turn it off and let cool completely.\nStrain out the mint leaves and lavender and pour the cooled syrup into an ice cube tray - should make roughly 4 syrup cubes. Place the tray in the freezer until syrup is frozen (the cubes may remain a little mushy as a result of all the sugar.)\nOnce the berries and herb-infused syrup cubes have frozen, you can make the sorbet. Place the frozen berries and syrup cubes in the bowl of a cuisinart or blender and add a few teaspoons of ice water to aid in blending. Continue to process or blend, adding small amounts of the ice water as needed, until smooth.\nServe, topped with a sprig of mint leaves and/or lavender.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "lay",
                "where": [
                  "cookie sheet"
                ],
                "ingredients": [
                  "berries"
                ],
                "tools": [],
                "temperature": null,
                "time": "until frozen through"
              },
              {
                "order": 2,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "water",
                  "sugar"
                ],
                "tools": [
                  "saucepan"
                ],
                "temperature": "medium",
                "time": "until it comes to a boil"
              },
              {
                "order": 3,
                "preparation_action": "turn off and let cool",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "completely"
              },
              {
                "order": 4,
                "preparation_action": "strain and pour",
                "where": [
                  "ice cube tray"
                ],
                "ingredients": [
                  "mint leaves",
                  "lavender",
                  "syrup"
                ],
                "tools": [],
                "temperature": null,
                "time": "until syrup is frozen"
              },
              {
                "order": 5,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "berries",
                  "syrup cubes",
                  "ice water"
                ],
                "tools": [
                  "cuisinart",
                  "blender"
                ],
                "temperature": null,
                "time": "until smooth"
              },
              {
                "order": 6,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "blackberries",
                "sugar",
                "water",
                "mint leaves",
                "old bay",
                "ice water"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 217.41,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "kosher",
            "dairy free",
            "vegetarian",
            "vegan",
            "gluten free",
            "halal"
          ],
          "is_vegetarian": true,
          "is_vegan": true,
          "is_gluten_free": true,
          "is_dairy_free": true,
          "cultura": "American",
          "estilo_cocina": "Moderno"
        },
        "similarity_features": {
          "total_ingredients_count": 23,
          "complexity_score": 50.0,
          "health_factor": 75.0,
          "cuisine_diversity": 0
        }
      },
      "case_saved": false,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_019",
      "description": "Iteration Test: Max iterations reached without valid solution",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.049242258071899414,
      "iterations": 1,
      "final_menu": {
        "menu_id": 2,
        "menu_name": "Menu 2: Simple Squash Salad",
        "description": "Complete menu featuring Simple Squash Salad as main course",
        "courses": {
          "starter": {
            "recipe_id": 650871,
            "title": "Maple & Curry Acorn Squash",
            "servings": 3,
            "price_per_serving": 57.52,
            "ready_in_minutes": 0,
            "ingredients": [
              "acorn squash",
              "curry powder",
              "maple syrup",
              "olive oil",
              "salt"
            ],
            "restrictions": [
              "soy free",
              "kosher",
              "dairy free",
              "vegetarian",
              "vegan",
              "nut free",
              "gluten free",
              "halal"
            ],
            "instructions": "<ol><li>Preheat oven to 400 F. Line a baking sheet with parchment paper or a silicone mat.</li><li>Rinse the outside of the acorn squash and then chop it in half. Seed the squash and chop off the stem. Next, slice it into one-inch wedges. I like use the natural grooves on the squash as a guide for thickness.</li><li>Place the sliced acorn squash in a medium-sized bowl. Add the rest of the ingredients to the bowl and stir until everything is well incorporated.</li><li>Lay the acorn squash in a single layer on top of the lined baking sheet, cut side down.</li><li>Bake for about 15 minutes. Flip the acorn squash slices to the other side so that both sides will be browned equally.</li><li>Bake the squash for another 10 to 15 minutes or until the pieces can be easily pierced with a fork.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "400 F",
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "line",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [
                  "parchment paper",
                  "silicone mat"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "rinse",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "seed",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "slice",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "place",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "curry powder",
                  "maple syrup",
                  "olive oil",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "stir",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "lay",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "15 minutes"
              },
              {
                "order": 5,
                "preparation_action": "flip",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "10 to 15 minutes"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "acorn squash",
                "curry powder",
                "maple syrup",
                "olive oil",
                "salt"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 660146,
            "title": "Simple Squash Salad",
            "servings": 6,
            "price_per_serving": 57.39,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "pepper",
              "parsley",
              "garlic",
              "garlic powder",
              "capers plus 2 tablespoons caper juice",
              "lemon",
              "onion",
              "oregano",
              "pepper flakes",
              "salt",
              "sugar",
              "vinegar",
              "zucchini"
            ],
            "restrictions": [
              "soy free",
              "kosher",
              "dairy free",
              "vegetarian",
              "vegan",
              "nut free",
              "gluten free",
              "halal"
            ],
            "instructions": "<ol><li>Combine all of the ingredients the salad ingredients in a bowl.</li><li>Combine all of the dressing ingredients in a cup and stir, adjust the ingredients to taste. </li><li> Pour this over the salad and toss. </li><li> Let the salad sit in the refrigerator for a few hours before serving.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "pepper",
                  "parsley",
                  "garlic",
                  "garlic powder",
                  "capers",
                  "caper juice",
                  "lemon",
                  "onion",
                  "oregano",
                  "pepper flakes",
                  "salt",
                  "sugar",
                  "vinegar",
                  "zucchini"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [
                  "cup"
                ],
                "ingredients": [
                  "dressing ingredients"
                ],
                "tools": [
                  "stir"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "pour",
                "where": [],
                "ingredients": [
                  "dressing"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "toss",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "a few hours"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "bell pepper",
                "pepper",
                "parsley",
                "garlic",
                "garlic powder",
                "capers plus 2 tablespoons caper juice",
                "lemon",
                "onion",
                "oregano",
                "pepper flakes",
                "salt",
                "sugar",
                "vinegar",
                "zucchini"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 665330,
            "title": "Wild Blackberry Sorbet With Garden Mint & Lavender",
            "servings": 4,
            "price_per_serving": 102.5,
            "ready_in_minutes": 0,
            "ingredients": [
              "blackberries",
              "sugar",
              "water",
              "mint leaves",
              "chives and dill",
              "ice water"
            ],
            "restrictions": [
              "soy free",
              "kosher",
              "dairy free",
              "vegetarian",
              "vegan",
              "nut free",
              "gluten free",
              "halal"
            ],
            "instructions": "Lay the clean, drained berries in a single layer on a cookie sheet and place in the freezer until frozen through. It is best to do both this and the next step the day or night before you plan to make the sorbet - just make sure you leave enough time for everything to freeze.\nMake the herb-infused simple syrup by combining the water and sugar in a small heavy-bottomed saucepan and heat over a medium flame until it comes to a boil. Turn it off and let cool completely.\nStrain out the mint leaves and lavender and pour the cooled syrup into an ice cube tray - should make roughly 4 syrup cubes. Place the tray in the freezer until syrup is frozen (the cubes may remain a little mushy as a result of all the sugar.)\nOnce the berries and herb-infused syrup cubes have frozen, you can make the sorbet. Place the frozen berries and syrup cubes in the bowl of a cuisinart or blender and add a few teaspoons of ice water to aid in blending. Continue to process or blend, adding small amounts of the ice water as needed, until smooth.\nServe, topped with a sprig of mint leaves and/or lavender.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "lay",
                "where": [
                  "cookie sheet"
                ],
                "ingredients": [
                  "berries"
                ],
                "tools": [],
                "temperature": null,
                "time": "until frozen through"
              },
              {
                "order": 2,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "water",
                  "sugar"
                ],
                "tools": [
                  "saucepan"
                ],
                "temperature": "medium",
                "time": "until it comes to a boil"
              },
              {
                "order": 3,
                "preparation_action": "turn off and let cool",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "completely"
              },
              {
                "order": 4,
                "preparation_action": "strain and pour",
                "where": [
                  "ice cube tray"
                ],
                "ingredients": [
                  "mint leaves",
                  "lavender",
                  "syrup"
                ],
                "tools": [],
                "temperature": null,
                "time": "until syrup is frozen"
              },
              {
                "order": 5,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "berries",
                  "syrup cubes",
                  "ice water"
                ],
                "tools": [
                  "cuisinart",
                  "blender"
                ],
                "temperature": null,
                "time": "until smooth"
              },
              {
                "order": 6,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "blackberries",
                "sugar",
                "water",
                "mint leaves",
                "chives and dill",
                "ice water"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 217.41,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "soy free",
            "kosher",
            "dairy free",
            "vegetarian",
            "vegan",
            "nut free",
            "gluten free",
            "halal"
          ],
          "is_vegetarian": true,
          "is_vegan": true,
          "is_gluten_free": true,
          "is_dairy_free": true,
          "cultura": "American",
          "estilo_cocina": "Moderno"
        },
        "similarity_features": {
          "total_ingredients_count": 23,
          "complexity_score": 50.0,
          "health_factor": 75.0,
          "cuisine_diversity": 0
        }
      },
      "case_saved": false,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_020",
      "description": "Edge Case: Unknown culture (should use fallback matching)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.04900097846984863,
      "iterations": 1,
      "final_menu": {
        "menu_id": 1,
        "menu_name": "Menu 1: Corn Salsa",
        "description": "Complete menu featuring Corn Salsa as main course",
        "courses": {
          "starter": {
            "recipe_id": 640062,
            "title": "Corn Avocado Salsa",
            "servings": 2,
            "price_per_serving": 130.73,
            "ready_in_minutes": 0,
            "ingredients": [
              "avocado",
              "balsamic vinegar",
              "cumin",
              "corn",
              "garlic",
              "bell pepper"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Preheat oven to 375 degrees.</li><li>Spread corn flat on a baking sheet.</li><li>Spray lightly with olive oil spray.</li><li>Roast corn in the oven for about 8-10 minutes. (Be careful not to brown too much or burn.)</li><li>Remove from heat and allow to cool.</li><li>Finely chop red pepper and garlic and mix in a bowl.</li><li>Peel and coarsely chop avocado and add to bowl.</li><li>Add cooled corn.</li><li>Mix in cumin and vinegar and blend well.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "375 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "spray",
                "where": [],
                "ingredients": [],
                "tools": [
                  "olive oil spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "roast",
                "where": [
                  "oven"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": "8-10 minutes"
              },
              {
                "order": 5,
                "preparation_action": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "allow",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "red pepper",
                  "garlic"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "peel",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "cumin",
                  "vinegar"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "blend",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "avocado",
                "balsamic vinegar",
                "cumin",
                "corn",
                "garlic",
                "bell pepper"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 640104,
            "title": "Corn Salsa",
            "servings": 4,
            "price_per_serving": 150.92,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "celery",
              "ears of corn - boil and from the cob",
              "basil",
              "garlic",
              "jalapeño",
              "onion",
              "salt",
              "sugar",
              "pickle",
              "vine tomato",
              "vinegar"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Combine all of the above ingredients in a bowl.</li><li>Combine the ingredients for the dressing and add to the salsa.</li><li>Serve chilled.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "celery",
                  "ears of corn",
                  "basil",
                  "garlic",
                  "jalapeño",
                  "onion",
                  "salt",
                  "sugar",
                  "pickle",
                  "vine tomato"
                ],
                "tools": [
                  "bowl"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [],
                "ingredients": [
                  "vinegar",
                  "salsa"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "chilled",
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "bell pepper",
                "celery",
                "ears of corn - boil and from the cob",
                "basil",
                "garlic",
                "jalapeño",
                "onion",
                "salt",
                "sugar",
                "pickle",
                "vine tomato",
                "vinegar"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 655202,
            "title": "Peanut Brittle",
            "servings": 4,
            "price_per_serving": 107.1,
            "ready_in_minutes": 0,
            "ingredients": [
              "butter",
              "soda",
              "coconut",
              "corn syrup",
              "peanuts",
              "salt",
              "sugar",
              "water"
            ],
            "restrictions": [
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Pour sugar, corn syrup and water into saucepan. Cook, stirring only until sugar is dissolved. Continue cooking until sugar begins to turn light brown (300 degrees) by candy thermometer. Remove from heat. Add salt, soda, butter and stir as little as possible, only to mix well. Stir in peanuts and coconut.Spread on a greased sheet of waxed paper set on top of a baking sheet and let the mixture cool and harden.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "pour",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cook",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [
                  "candy thermometer"
                ],
                "temperature": "300 degrees",
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "peanuts",
                  "coconut"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "cool and harden"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "butter",
                "soda",
                "coconut",
                "corn syrup",
                "peanuts",
                "salt",
                "sugar",
                "water"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 388.75,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "gluten free",
            "vegetarian"
          ],
          "is_vegetarian": true,
          "is_vegan": false,
          "is_gluten_free": true,
          "is_dairy_free": false,
          "cultura": "American",
          "estilo_cocina": "Tradicional"
        },
        "similarity_features": {
          "total_ingredients_count": 22,
          "complexity_score": 52.0,
          "health_factor": 61.7,
          "cuisine_diversity": 0
        }
      },
      "case_saved": false,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_021",
      "description": "Edge Case: Unknown restriction (should ignore gracefully)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.07486081123352051,
      "iterations": 1,
      "final_menu": {
        "menu_id": 1,
        "menu_name": "Menu 1: Corn Salsa",
        "description": "Complete menu featuring Corn Salsa as main course",
        "courses": {
          "starter": {
            "recipe_id": 640062,
            "title": "Corn Avocado Salsa",
            "servings": 2,
            "price_per_serving": 130.73,
            "ready_in_minutes": 0,
            "ingredients": [
              "avocado",
              "balsamic vinegar",
              "cumin",
              "corn",
              "garlic",
              "bell pepper"
            ],
            "restrictions": [
              "dairy free",
              "paleo",
              "keto",
              "unknown restriction",
              "vegetarian",
              "vegan",
              "gluten free"
            ],
            "instructions": "<ol><li>Preheat oven to 375 degrees.</li><li>Spread corn flat on a baking sheet.</li><li>Spray lightly with olive oil spray.</li><li>Roast corn in the oven for about 8-10 minutes. (Be careful not to brown too much or burn.)</li><li>Remove from heat and allow to cool.</li><li>Finely chop red pepper and garlic and mix in a bowl.</li><li>Peel and coarsely chop avocado and add to bowl.</li><li>Add cooled corn.</li><li>Mix in cumin and vinegar and blend well.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "375 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "spray",
                "where": [],
                "ingredients": [],
                "tools": [
                  "olive oil spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "roast",
                "where": [
                  "oven"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": "8-10 minutes"
              },
              {
                "order": 5,
                "preparation_action": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "allow",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "red pepper",
                  "garlic"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "peel",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "cumin",
                  "vinegar"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "blend",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "avocado",
                "balsamic vinegar",
                "cumin",
                "corn",
                "garlic",
                "bell pepper"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 640104,
            "title": "Corn Salsa",
            "servings": 4,
            "price_per_serving": 150.92,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "celery",
              "ears of corn - boil and from the cob",
              "basil",
              "garlic",
              "jalapeño",
              "onion",
              "salt",
              "sugar",
              "pickle",
              "vine tomato",
              "vinegar"
            ],
            "restrictions": [
              "dairy free",
              "paleo",
              "keto",
              "unknown restriction",
              "vegetarian",
              "vegan",
              "gluten free"
            ],
            "instructions": "<ol><li>Combine all of the above ingredients in a bowl.</li><li>Combine the ingredients for the dressing and add to the salsa.</li><li>Serve chilled.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "celery",
                  "ears of corn",
                  "basil",
                  "garlic",
                  "jalapeño",
                  "onion",
                  "salt",
                  "sugar",
                  "pickle",
                  "vine tomato"
                ],
                "tools": [
                  "bowl"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [],
                "ingredients": [
                  "vinegar",
                  "salsa"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "chilled",
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "bell pepper",
                "celery",
                "ears of corn - boil and from the cob",
                "basil",
                "garlic",
                "jalapeño",
                "onion",
                "salt",
                "sugar",
                "pickle",
                "vine tomato",
                "vinegar"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 655202,
            "title": "Peanut Brittle",
            "servings": 4,
            "price_per_serving": 107.1,
            "ready_in_minutes": 0,
            "ingredients": [
              "butter",
              "soda",
              "coconut",
              "corn syrup",
              "peanuts",
              "salt",
              "sugar",
              "water"
            ],
            "restrictions": [
              "paleo",
              "vegetarian",
              "keto",
              "unknown restriction",
              "gluten free"
            ],
            "instructions": "<ol><li>Pour sugar, corn syrup and water into saucepan. Cook, stirring only until sugar is dissolved. Continue cooking until sugar begins to turn light brown (300 degrees) by candy thermometer. Remove from heat. Add salt, soda, butter and stir as little as possible, only to mix well. Stir in peanuts and coconut.Spread on a greased sheet of waxed paper set on top of a baking sheet and let the mixture cool and harden.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "pour",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cook",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [
                  "candy thermometer"
                ],
                "temperature": "300 degrees",
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "peanuts",
                  "coconut"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "cool and harden"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "butter",
                "soda",
                "coconut",
                "corn syrup",
                "peanuts",
                "salt",
                "sugar",
                "water"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 388.75,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "paleo",
            "unknown restriction",
            "keto",
            "vegetarian",
            "gluten free"
          ],
          "is_vegetarian": true,
          "is_vegan": false,
          "is_gluten_free": true,
          "is_dairy_free": false,
          "cultura": "American",
          "estilo_cocina": "Tradicional"
        },
        "similarity_features": {
          "total_ingredients_count": 22,
          "complexity_score": 52.0,
          "health_factor": 61.7,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_022",
      "description": "Edge Case: Contradictory restrictions (vegan + dairy)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.1004328727722168,
      "iterations": 1,
      "final_menu": {
        "menu_id": 8,
        "menu_name": "Menu 8: Pasta With Chickpeas and Kale",
        "description": "Complete menu featuring Pasta With Chickpeas and Kale as main course",
        "courses": {
          "starter": {
            "recipe_id": 658674,
            "title": "Roasted Sunchoke, Apple, and Onion Soup",
            "servings": 12,
            "price_per_serving": 202.79,
            "ready_in_minutes": 0,
            "ingredients": [
              "sunchokes",
              "onion",
              "apple",
              "vegetable stock",
              "olive oil",
              "s&p"
            ],
            "restrictions": [
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free",
              "dairy"
            ],
            "instructions": "Preheat oven to 400 degrees\nPeel sunchokes (best you can but don't obsess) and cut into die-sized pieces\nLarge dice onion\nSlice apple in half lengthwise and core\nToss all three in olive oil and place on a sheet pan on the bottom rack\nSet timer for 20 mins and then shake pan\nAfter that, shake and check more frequently\nRemove apples when soft and let cool then peel\nLeave sunchokes and onion in until some of the onion start to char\nAdd roasted vegetables to 4 cups liquid (stock)\nHeat until sunchokes are soft; they may already be from the roasting\nPuree in blender",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [
                  "oven"
                ],
                "temperature": "400 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "peel",
                "where": [
                  "sunchokes"
                ],
                "ingredients": [
                  "sunchokes"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cut",
                "where": [
                  "sunchokes"
                ],
                "ingredients": [
                  "sunchokes"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "dice",
                "where": [
                  "onion"
                ],
                "ingredients": [
                  "onion"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "slice",
                "where": [
                  "apple"
                ],
                "ingredients": [
                  "apple"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "core",
                "where": [
                  "apple"
                ],
                "ingredients": [
                  "apple"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "toss",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [
                  "sunchokes",
                  "onion",
                  "apple",
                  "olive oil"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "place",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "set",
                "where": [],
                "ingredients": [],
                "tools": [
                  "timer"
                ],
                "temperature": null,
                "time": "20 mins"
              },
              {
                "order": 7,
                "preparation_action": "shake",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "shake",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "check",
                "where": [
                  "sheet pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "remove",
                "where": [
                  "apples"
                ],
                "ingredients": [
                  "apples"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "let cool",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "peel",
                "where": [
                  "apples"
                ],
                "ingredients": [
                  "apples"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "leave",
                "where": [
                  "sunchokes",
                  "onion"
                ],
                "ingredients": [
                  "sunchokes",
                  "onion"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "char",
                "where": [
                  "onion"
                ],
                "ingredients": [
                  "onion"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "sunchokes",
                  "onion",
                  "vegetable stock"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "heat",
                "where": [],
                "ingredients": [
                  "sunchokes",
                  "onion",
                  "vegetable stock"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "puree",
                "where": [],
                "ingredients": [
                  "sunchokes",
                  "onion",
                  "vegetable stock"
                ],
                "tools": [
                  "blender"
                ],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "sunchokes",
                "onion",
                "apple",
                "vegetable stock",
                "olive oil",
                "s&p"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 654905,
            "title": "Pasta With Chickpeas and Kale",
            "servings": 4,
            "price_per_serving": 243.81,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "chickpeas",
              "garlic",
              "kale",
              "olive oil",
              "parsley",
              "salt and pepper",
              "ziti"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "dairy",
              "vegetarian"
            ],
            "instructions": "<ol><li>Set a large pot of water to boil, and add salt. Cut the kale stems into 2-3 inch pieces; chop the leaves coarsely and set aside. Boil the stems until they are nearly tender; then, add the greens. Cook until kale is quite tender but stillbright green. Scoop it out with a slotted spoon, place in a bowl of ice water, and keep pot boiling. When the kale cools, squeeze out excess water, gather it into a mass and chop rather finely. Meanwhile, place olive oil in a large skillet over ve</li><li>Warm the garlic mixture over medium heat, and add the cooked pasta, the chickpeas and the chopped kale.</li><li>Toss well, taste for seasoning, garnish with parsley and serve immediately.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "set",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "water",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "cut",
                "where": [
                  "kale stems"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "chop",
                "where": [
                  "kale leaves"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "boil",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "kale stems",
                  "water",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "boil",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "cook",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "scoop",
                "where": [
                  "pot"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [
                  "slotted spoon"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "place",
                "where": [
                  "bowl of ice water"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "keep",
                "where": [
                  "pot"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "cool",
                "where": [
                  "kale"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "squeeze",
                "where": [
                  "kale"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "gather",
                "where": [
                  "kale"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "chop",
                "where": [
                  "kale"
                ],
                "ingredients": [
                  "kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "warm",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [
                  "garlic mixture"
                ],
                "tools": [],
                "temperature": "medium heat",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "add",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [
                  "cooked pasta",
                  "chickpeas",
                  "chopped kale"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "toss",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "taste",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "garnish",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [
                  "parsley"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [
                  "garlic mixture"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "bell pepper",
                "chickpeas",
                "garlic",
                "kale",
                "olive oil",
                "parsley",
                "salt and pepper",
                "ziti"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 646524,
            "title": "Healthy Vegan Red Velvet Brownies",
            "servings": 8,
            "price_per_serving": 41.97,
            "ready_in_minutes": 0,
            "ingredients": [
              "almond extract",
              "apple sauce",
              "baking powder",
              "baking soda",
              "beets",
              "brown sugar",
              "cocoa powder",
              "ground flaxseed",
              "kidney beans",
              "salt",
              "vanilla extract"
            ],
            "restrictions": [
              "dairy free",
              "vegetarian",
              "vegan",
              "gluten free",
              "dairy"
            ],
            "instructions": "<ol><li>Preheat oven to 350 F.</li><li>Spray an 8x8 inch pan with cooking spray. Set aside.</li><li>In a food processor, puree kidney beans and beets. Transfer to a large bowl.</li><li>Add remaining ingredients and mix by hand until smooth and fully combined.</li><li>Fold batter into the greased pan.</li><li>Bake for 35-40 minutes, turning the pan halfway through.</li><li>When the brownies are done, test them with a toothpick. You want some batter to cling to the toothpick. Do not over bake.</li><li>Let cool completely. Refrigerate for one hour.</li><li>Cut into squares or use cookie cutters to make heart shapes.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [
                  "oven"
                ],
                "temperature": "350 F",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spray",
                "where": [
                  "pan"
                ],
                "ingredients": [],
                "tools": [
                  "cooking spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "set",
                "where": [
                  "aside"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "puree",
                "where": [
                  "food processor"
                ],
                "ingredients": [
                  "kidney beans",
                  "beets"
                ],
                "tools": [
                  "food processor"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "transfer",
                "where": [
                  "large bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "almond extract",
                  "apple sauce",
                  "baking powder",
                  "baking soda",
                  "brown sugar",
                  "cocoa powder",
                  "ground flaxseed",
                  "salt",
                  "vanilla extract"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "mix",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "fold",
                "where": [
                  "greased pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "35-40 minutes"
              },
              {
                "order": 6,
                "preparation_action": "turn",
                "where": [
                  "pan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "test",
                "where": [],
                "ingredients": [],
                "tools": [
                  "toothpick"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "completely"
              },
              {
                "order": 8,
                "preparation_action": "refrigerate",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "one hour"
              },
              {
                "order": 9,
                "preparation_action": "cut",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "almond extract",
                "apple sauce",
                "baking powder",
                "baking soda",
                "beets",
                "brown sugar",
                "cocoa powder",
                "ground flaxseed",
                "kidney beans",
                "salt",
                "vanilla extract"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 488.57,
          "price_category": "premium",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Winter",
          "wine_pairing": " No wine pairing",
          "is_kosher": false,
          "is_halal": true,
          "common_dietary_restrictions": [
            "vegan",
            "dairy free",
            "dairy",
            "vegetarian"
          ],
          "is_vegetarian": true,
          "is_vegan": true,
          "is_gluten_free": false,
          "is_dairy_free": true,
          "cultura": "Italian",
          "estilo_cocina": "Moderno/Saludable"
        },
        "similarity_features": {
          "total_ingredients_count": 24,
          "complexity_score": 50.0,
          "health_factor": 70.0,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_023",
      "description": "Retain Test: Near-duplicate case (high similarity, low novelty)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.11419987678527832,
      "iterations": 1,
      "final_menu": {
        "menu_id": 1,
        "menu_name": "Menu 1: Corn Salsa",
        "description": "Complete menu featuring Corn Salsa as main course",
        "courses": {
          "starter": {
            "recipe_id": 640062,
            "title": "Corn Avocado Salsa",
            "servings": 2,
            "price_per_serving": 130.73,
            "ready_in_minutes": 0,
            "ingredients": [
              "avocado",
              "balsamic vinegar",
              "cumin",
              "corn",
              "garlic",
              "bell pepper"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Preheat oven to 375 degrees.</li><li>Spread corn flat on a baking sheet.</li><li>Spray lightly with olive oil spray.</li><li>Roast corn in the oven for about 8-10 minutes. (Be careful not to brown too much or burn.)</li><li>Remove from heat and allow to cool.</li><li>Finely chop red pepper and garlic and mix in a bowl.</li><li>Peel and coarsely chop avocado and add to bowl.</li><li>Add cooled corn.</li><li>Mix in cumin and vinegar and blend well.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "375 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "spray",
                "where": [],
                "ingredients": [],
                "tools": [
                  "olive oil spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "roast",
                "where": [
                  "oven"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": "8-10 minutes"
              },
              {
                "order": 5,
                "preparation_action": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "allow",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "red pepper",
                  "garlic"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "peel",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "cumin",
                  "vinegar"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "blend",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          },
          "main": {
            "recipe_id": 640104,
            "title": "Corn Salsa",
            "servings": 4,
            "price_per_serving": 150.92,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "celery",
              "ears of corn - boil and from the cob",
              "basil",
              "garlic",
              "jalapeño",
              "onion",
              "salt",
              "sugar",
              "pickle",
              "vine tomato",
              "vinegar"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Combine all of the above ingredients in a bowl.</li><li>Combine the ingredients for the dressing and add to the salsa.</li><li>Serve chilled.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "celery",
                  "ears of corn",
                  "basil",
                  "garlic",
                  "jalapeño",
                  "onion",
                  "salt",
                  "sugar",
                  "pickle",
                  "vine tomato"
                ],
                "tools": [
                  "bowl"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [],
                "ingredients": [
                  "vinegar",
                  "salsa"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "chilled",
                "time": null
              }
            ]
          },
          "dessert": {
            "recipe_id": 655202,
            "title": "Peanut Brittle",
            "servings": 4,
            "price_per_serving": 107.1,
            "ready_in_minutes": 0,
            "ingredients": [
              "butter",
              "soda",
              "coconut",
              "corn syrup",
              "peanuts",
              "salt",
              "sugar",
              "water"
            ],
            "restrictions": [
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Pour sugar, corn syrup and water into saucepan. Cook, stirring only until sugar is dissolved. Continue cooking until sugar begins to turn light brown (300 degrees) by candy thermometer. Remove from heat. Add salt, soda, butter and stir as little as possible, only to mix well. Stir in peanuts and coconut.Spread on a greased sheet of waxed paper set on top of a baking sheet and let the mixture cool and harden.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "pour",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cook",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [
                  "candy thermometer"
                ],
                "temperature": "300 degrees",
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "peanuts",
                  "coconut"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "cool and harden"
              }
            ]
          }
        },
        "features": {
          "total_price_per_serving": 388.75,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "vegetarian",
            "gluten free"
          ],
          "is_vegetarian": true,
          "is_vegan": false,
          "is_gluten_free": true,
          "is_dairy_free": false,
          "cultura": "American",
          "estilo_cocina": "Tradicional"
        },
        "similarity_features": {
          "total_ingredients_count": 22,
          "complexity_score": 52.0,
          "health_factor": 61.7,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_024",
      "description": "Edge Case: Empty ingredient list in a course",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.097076416015625,
      "iterations": 1,
      "final_menu": {
        "menu_id": 3,
        "menu_name": "Menu 3: Zucchini Ribbon Caper Salad",
        "description": "Complete menu featuring Zucchini Ribbon Caper Salad as main course",
        "courses": {
          "starter": {
            "recipe_id": 641057,
            "title": "Curried Butternut Squash and Apple Soup",
            "servings": 1,
            "price_per_serving": 141.44,
            "ready_in_minutes": 0,
            "ingredients": [
              "cauliflower",
              "butternut squash",
              "apple",
              "water",
              "braggs liquid aminos",
              "curry powder",
              "ginger powder",
              "a squirt sriracha",
              "block lite tofu"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "Get ready two small saucepans.\nIn one have together 1/2 of the squash and 1/2 of the apple  bring to a simmer, and simmer until just tender when pierced with a fork.\nIn the other, add in the rest of the vegetables along with 1 cup of water  bring this to a rolling boil, reduce to a simmer, and simmer until very very tender. When very tender, remove the vegetables from the heat, and blend these vegetables together (without draining) with the Braggs, spices, sriracha and the additional 1/2 cup water.\nMix the blended part of the soup with the simmered squash and apples. Mix in the cubed tofu, gently re-heat and serve.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "get ready",
                "where": [
                  "kitchen"
                ],
                "ingredients": [],
                "tools": [
                  "saucepans"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "have",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "butternut squash",
                  "apple"
                ],
                "tools": [
                  "fork"
                ],
                "temperature": "simmer",
                "time": "until just tender"
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "cauliflower",
                  "water"
                ],
                "tools": [],
                "temperature": "rolling boil",
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "bring",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "rolling boil",
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "reduce",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "simmer",
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "simmer",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "simmer",
                "time": "until very tender"
              },
              {
                "order": 7,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "blend",
                "where": [
                  "blender"
                ],
                "ingredients": [
                  "cauliflower",
                  "Braggs liquid aminos",
                  "curry powder",
                  "ginger powder",
                  "sriracha",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "mix",
                "where": [
                  "kitchen"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "mix",
                "where": [
                  "kitchen"
                ],
                "ingredients": [
                  "butternut squash",
                  "apple"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "kitchen"
                ],
                "ingredients": [
                  "block lite tofu"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "re-heat",
                "where": [
                  "kitchen"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "serve",
                "where": [
                  "kitchen"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          },
          "main": {
            "recipe_id": 665777,
            "title": "Zucchini Ribbon Caper Salad",
            "servings": 3,
            "price_per_serving": 66.59,
            "ready_in_minutes": 0,
            "ingredients": [
              "capers",
              "garlic",
              "lemon zest",
              "olive oil",
              "salt and pepper",
              "tomato",
              "zucchini"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Toss the zucchini strips with the oil, lemon zest and juice, garlic, salt and pepper. Set aside for 30 minutes to marinate.</li><li>Divide between 2-3 plates and top with capers, tomato julienne. Drizzle any extra dressing over if desired. To garnish, sprinkle a pinch of dried parsley over.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "toss",
                "where": [
                  "aside"
                ],
                "ingredients": [
                  "zucchini",
                  "oil",
                  "lemon zest",
                  "garlic",
                  "salt",
                  "pepper"
                ],
                "tools": [],
                "temperature": null,
                "time": "30 minutes"
              },
              {
                "order": 2,
                "preparation_action": "divide",
                "where": [
                  "plates"
                ],
                "ingredients": [
                  "capers",
                  "tomato"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "top",
                "where": [
                  "plates"
                ],
                "ingredients": [
                  "capers",
                  "tomato"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "drizzle",
                "where": [
                  "plates"
                ],
                "ingredients": [
                  "dressing"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "garnish",
                "where": [
                  "plates"
                ],
                "ingredients": [
                  "parsley"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          },
          "dessert": {
            "recipe_id": 664474,
            "title": "Vegan Pumpkin Pie Butter Cups",
            "servings": 16,
            "price_per_serving": 272.35,
            "ready_in_minutes": 0,
            "ingredients": [
              "chocolate pie crust",
              "cocoa powder",
              "walnuts",
              "coconut",
              "medjool dates",
              "chocolate shell",
              "cocoa powder",
              "tbs coconut oil",
              "maple syrup",
              "pumpkin puree",
              "peanut butter",
              "maple syrup",
              "chia seeds",
              "pumpkin pie spice"
            ],
            "restrictions": [
              "dairy free"
            ],
            "instructions": "Line 16 muffin cups with paper or silicone liners. The butter cups are easier to take out if you use paper liners.\nIn a food processor, blend all of the chocolate crust ingredients together.\nDrop a tablespoon of the crust into each cup and flatten it at the bottom.\nIn a small bowl, mix the ingredients for the pumpkin filling together. Freeze it for 5-10 minutes.\nMix the chocolate shell ingredients together until it looks like chocolate sauce.\nRemove the pumpkin filling and drop -tablespoon dollops of the pie filling into each cup.\nPour about 2 teaspoons of chocolate sauce into each cup so that you could just about cover up the pumpkin filling.\nFreeze the cups for 30 minutes to an hour.\nStore in the refrigerator. The chocolate will turn gooey if you leave the cups out in room temperature for a long time.\nEnjoy!",
            "structured_instructions": [
              {
                "order": 1,
                "preparation": "line",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [
                  "paper liners",
                  "silicone liners"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation": "use",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation": "blend",
                "where": [
                  "food processor"
                ],
                "ingredients": [
                  "chocolate crust"
                ],
                "tools": [
                  "food processor"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation": "drop",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [
                  "crust"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation": "flatten",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation": "mix",
                "where": [
                  "small bowl"
                ],
                "ingredients": [
                  "pumpkin filling"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation": "freeze",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "5-10 minutes"
              },
              {
                "order": 8,
                "preparation": "mix",
                "where": [],
                "ingredients": [
                  "chocolate shell"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation": "drop",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [
                  "pie filling"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation": "pour",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [
                  "chocolate sauce"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation": "freeze",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "30 minutes to an hour"
              },
              {
                "order": 13,
                "preparation": "store",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 14,
                "preparation": "enjoy",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          }
        },
        "features": {
          "total_price_per_serving": 480.38,
          "price_category": "premium",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": false,
          "common_dietary_restrictions": [
            "dairy free"
          ],
          "is_vegetarian": false,
          "is_vegan": false,
          "is_gluten_free": false,
          "is_dairy_free": true,
          "cultura": "Mediterranean",
          "estilo_cocina": "Moderno/Vegano"
        },
        "similarity_features": {
          "total_ingredients_count": 28,
          "complexity_score": 60.0,
          "health_factor": 53.3,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_025",
      "description": "Robustness Test: Empty case base (simulated)",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.0,
      "iterations": 0,
      "final_menu": null,
      "case_saved": false,
      "error": null
    },
    {
      "test_id": "TEST_026",
      "description": "Edge Case: All ingredients violate restrictions",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.13507819175720215,
      "iterations": 1,
      "final_menu": {
        "menu_id": 2,
        "menu_name": "Menu 2: Simple Squash Salad",
        "description": "Complete menu featuring Simple Squash Salad as main course",
        "courses": {
          "starter": {
            "recipe_id": 650871,
            "title": "Maple & Curry Acorn Squash",
            "servings": 3,
            "price_per_serving": 57.52,
            "ready_in_minutes": 0,
            "ingredients": [
              "acorn squash",
              "curry powder",
              "maple syrup",
              "olive oil",
              "salt"
            ],
            "restrictions": [
              "soy free",
              "dairy free",
              "vegetarian",
              "vegan",
              "nut free",
              "gluten free"
            ],
            "instructions": "<ol><li>Preheat oven to 400 F. Line a baking sheet with parchment paper or a silicone mat.</li><li>Rinse the outside of the acorn squash and then chop it in half. Seed the squash and chop off the stem. Next, slice it into one-inch wedges. I like use the natural grooves on the squash as a guide for thickness.</li><li>Place the sliced acorn squash in a medium-sized bowl. Add the rest of the ingredients to the bowl and stir until everything is well incorporated.</li><li>Lay the acorn squash in a single layer on top of the lined baking sheet, cut side down.</li><li>Bake for about 15 minutes. Flip the acorn squash slices to the other side so that both sides will be browned equally.</li><li>Bake the squash for another 10 to 15 minutes or until the pieces can be easily pierced with a fork.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "400 F",
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "line",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [
                  "parchment paper",
                  "silicone mat"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "rinse",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "seed",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "slice",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "place",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "curry powder",
                  "maple syrup",
                  "olive oil",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "stir",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "lay",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "15 minutes"
              },
              {
                "order": 5,
                "preparation_action": "flip",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "10 to 15 minutes"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "acorn squash",
                "curry powder",
                "maple syrup",
                "olive oil",
                "salt"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 660146,
            "title": "Simple Squash Salad",
            "servings": 6,
            "price_per_serving": 57.39,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "pepper",
              "parsley",
              "garlic",
              "garlic powder",
              "capers plus 2 tablespoons caper juice",
              "lemon",
              "onion",
              "oregano",
              "pepper flakes",
              "salt",
              "sugar",
              "vinegar",
              "zucchini"
            ],
            "restrictions": [
              "soy free",
              "dairy free",
              "vegetarian",
              "vegan",
              "nut free",
              "gluten free"
            ],
            "instructions": "<ol><li>Combine all of the ingredients the salad ingredients in a bowl.</li><li>Combine all of the dressing ingredients in a cup and stir, adjust the ingredients to taste. </li><li> Pour this over the salad and toss. </li><li> Let the salad sit in the refrigerator for a few hours before serving.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "pepper",
                  "parsley",
                  "garlic",
                  "garlic powder",
                  "capers",
                  "caper juice",
                  "lemon",
                  "onion",
                  "oregano",
                  "pepper flakes",
                  "salt",
                  "sugar",
                  "vinegar",
                  "zucchini"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [
                  "cup"
                ],
                "ingredients": [
                  "dressing ingredients"
                ],
                "tools": [
                  "stir"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "pour",
                "where": [],
                "ingredients": [
                  "dressing"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "toss",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "a few hours"
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "bell pepper",
                "pepper",
                "parsley",
                "garlic",
                "garlic powder",
                "capers plus 2 tablespoons caper juice",
                "lemon",
                "onion",
                "oregano",
                "pepper flakes",
                "salt",
                "sugar",
                "vinegar",
                "zucchini"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 665330,
            "title": "Wild Blackberry Sorbet With Garden Mint & Lavender",
            "servings": 4,
            "price_per_serving": 102.5,
            "ready_in_minutes": 0,
            "ingredients": [
              "blackberries",
              "sugar",
              "water",
              "mint leaves",
              "chives and dill",
              "ice water"
            ],
            "restrictions": [
              "soy free",
              "dairy free",
              "vegetarian",
              "vegan",
              "nut free",
              "gluten free"
            ],
            "instructions": "Lay the clean, drained berries in a single layer on a cookie sheet and place in the freezer until frozen through. It is best to do both this and the next step the day or night before you plan to make the sorbet - just make sure you leave enough time for everything to freeze.\nMake the herb-infused simple syrup by combining the water and sugar in a small heavy-bottomed saucepan and heat over a medium flame until it comes to a boil. Turn it off and let cool completely.\nStrain out the mint leaves and lavender and pour the cooled syrup into an ice cube tray - should make roughly 4 syrup cubes. Place the tray in the freezer until syrup is frozen (the cubes may remain a little mushy as a result of all the sugar.)\nOnce the berries and herb-infused syrup cubes have frozen, you can make the sorbet. Place the frozen berries and syrup cubes in the bowl of a cuisinart or blender and add a few teaspoons of ice water to aid in blending. Continue to process or blend, adding small amounts of the ice water as needed, until smooth.\nServe, topped with a sprig of mint leaves and/or lavender.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "lay",
                "where": [
                  "cookie sheet"
                ],
                "ingredients": [
                  "berries"
                ],
                "tools": [],
                "temperature": null,
                "time": "until frozen through"
              },
              {
                "order": 2,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "water",
                  "sugar"
                ],
                "tools": [
                  "saucepan"
                ],
                "temperature": "medium",
                "time": "until it comes to a boil"
              },
              {
                "order": 3,
                "preparation_action": "turn off and let cool",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "completely"
              },
              {
                "order": 4,
                "preparation_action": "strain and pour",
                "where": [
                  "ice cube tray"
                ],
                "ingredients": [
                  "mint leaves",
                  "lavender",
                  "syrup"
                ],
                "tools": [],
                "temperature": null,
                "time": "until syrup is frozen"
              },
              {
                "order": 5,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "berries",
                  "syrup cubes",
                  "ice water"
                ],
                "tools": [
                  "cuisinart",
                  "blender"
                ],
                "temperature": null,
                "time": "until smooth"
              },
              {
                "order": 6,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "blackberries",
                "sugar",
                "water",
                "mint leaves",
                "chives and dill",
                "ice water"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 217.41,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "soy free",
            "dairy free",
            "vegetarian",
            "vegan",
            "nut free",
            "gluten free"
          ],
          "is_vegetarian": true,
          "is_vegan": true,
          "is_gluten_free": true,
          "is_dairy_free": true,
          "cultura": "American",
          "estilo_cocina": "Moderno"
        },
        "similarity_features": {
          "total_ingredients_count": 23,
          "complexity_score": 50.0,
          "health_factor": 75.0,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_027",
      "description": "Interactive Test: User feedback with rating and additional restriction",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.13136887550354004,
      "iterations": 2,
      "final_menu": {
        "menu_id": 1,
        "menu_name": "Menu 1: Corn Salsa",
        "description": "Complete menu featuring Corn Salsa as main course",
        "courses": {
          "starter": {
            "recipe_id": 640062,
            "title": "Corn Avocado Salsa",
            "servings": 2,
            "price_per_serving": 130.73,
            "ready_in_minutes": 0,
            "ingredients": [
              "avocado",
              "balsamic vinegar",
              "cumin",
              "corn",
              "garlic",
              "bell pepper"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Preheat oven to 375 degrees.</li><li>Spread corn flat on a baking sheet.</li><li>Spray lightly with olive oil spray.</li><li>Roast corn in the oven for about 8-10 minutes. (Be careful not to brown too much or burn.)</li><li>Remove from heat and allow to cool.</li><li>Finely chop red pepper and garlic and mix in a bowl.</li><li>Peel and coarsely chop avocado and add to bowl.</li><li>Add cooled corn.</li><li>Mix in cumin and vinegar and blend well.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "375 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "spray",
                "where": [],
                "ingredients": [],
                "tools": [
                  "olive oil spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "roast",
                "where": [
                  "oven"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": "8-10 minutes"
              },
              {
                "order": 5,
                "preparation_action": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "allow",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "red pepper",
                  "garlic"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "peel",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "cumin",
                  "vinegar"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "blend",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "avocado",
                "balsamic vinegar",
                "cumin",
                "corn",
                "garlic",
                "bell pepper"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 640104,
            "title": "Corn Salsa",
            "servings": 4,
            "price_per_serving": 150.92,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "celery",
              "ears of corn - boil and from the cob",
              "basil",
              "garlic",
              "jalapeño",
              "onion",
              "salt",
              "sugar",
              "marinated jalapeno",
              "vine tomato",
              "vinegar"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Combine all of the above ingredients in a bowl.</li><li>Combine the ingredients for the dressing and add to the salsa.</li><li>Serve chilled.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "celery",
                  "ears of corn",
                  "basil",
                  "garlic",
                  "jalapeño",
                  "onion",
                  "salt",
                  "sugar",
                  "pickle",
                  "vine tomato"
                ],
                "tools": [
                  "bowl"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [],
                "ingredients": [
                  "vinegar",
                  "salsa"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "chilled",
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "ears of corn - boil and from the cob",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "jalapeño",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "pickle",
                  "substitute": "marinated jalapeno",
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 1 candidatos"
                  ],
                  "candidates_found": 1,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "bell pepper",
                "celery",
                "ears of corn - boil and from the cob",
                "basil",
                "garlic",
                "jalapeño",
                "onion",
                "salt",
                "sugar",
                "pickle",
                "vine tomato",
                "vinegar"
              ],
              "ingredients_substituted": 1,
              "ingredients_removed": 0,
              "ingredients_kept": 2,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 4,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 1,
                "pending_ingredients": [
                  "vine tomato"
                ],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 655202,
            "title": "Peanut Brittle",
            "servings": 4,
            "price_per_serving": 107.1,
            "ready_in_minutes": 0,
            "ingredients": [
              "butter",
              "carbonated water",
              "strawberry",
              "honey",
              "peanuts",
              "salt",
              "sugar",
              "water"
            ],
            "restrictions": [
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Pour sugar, corn syrup and water into saucepan. Cook, stirring only until sugar is dissolved. Continue cooking until sugar begins to turn light brown (300 degrees) by candy thermometer. Remove from heat. Add salt, soda, butter and stir as little as possible, only to mix well. Stir in peanuts and coconut.Spread on a greased sheet of waxed paper set on top of a baking sheet and let the mixture cool and harden.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "pour",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cook",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [
                  "candy thermometer"
                ],
                "temperature": "300 degrees",
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "peanuts",
                  "coconut"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "cool and harden"
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "soda",
                  "substitute": "carbonated water",
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 3 candidatos"
                  ],
                  "candidates_found": 3,
                  "action": "substituted"
                },
                {
                  "original": "coconut",
                  "substitute": "strawberry",
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (category): 33 candidatos"
                  ],
                  "candidates_found": 33,
                  "action": "substituted"
                },
                {
                  "original": "corn syrup",
                  "substitute": "honey",
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (category): 7 candidatos"
                  ],
                  "candidates_found": 7,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "butter",
                "soda",
                "coconut",
                "corn syrup",
                "peanuts",
                "salt",
                "sugar",
                "water"
              ],
              "ingredients_substituted": 3,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 4,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 1,
                "pending_ingredients": [
                  "peanuts"
                ],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 388.75,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "gluten free",
            "vegetarian"
          ],
          "is_vegetarian": true,
          "is_vegan": false,
          "is_gluten_free": true,
          "is_dairy_free": false,
          "cultura": "American",
          "estilo_cocina": "Tradicional"
        },
        "similarity_features": {
          "total_ingredients_count": 22,
          "complexity_score": 52.0,
          "health_factor": 61.7,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_028",
      "description": "Interactive Test: User feedback with culture adjustment",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.11858558654785156,
      "iterations": 1,
      "final_menu": {
        "menu_id": 3,
        "menu_name": "Menu 3: Zucchini Ribbon Caper Salad",
        "description": "Complete menu featuring Zucchini Ribbon Caper Salad as main course",
        "courses": {
          "starter": {
            "recipe_id": 641057,
            "title": "Curried Butternut Squash and Apple Soup",
            "servings": 1,
            "price_per_serving": 141.44,
            "ready_in_minutes": 0,
            "ingredients": [
              "cauliflower",
              "butternut squash",
              "apple",
              "water",
              "braggs liquid aminos",
              "curry powder",
              "ginger powder",
              "a squirt sriracha",
              "block lite tofu"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "Get ready two small saucepans.\nIn one have together 1/2 of the squash and 1/2 of the apple  bring to a simmer, and simmer until just tender when pierced with a fork.\nIn the other, add in the rest of the vegetables along with 1 cup of water  bring this to a rolling boil, reduce to a simmer, and simmer until very very tender. When very tender, remove the vegetables from the heat, and blend these vegetables together (without draining) with the Braggs, spices, sriracha and the additional 1/2 cup water.\nMix the blended part of the soup with the simmered squash and apples. Mix in the cubed tofu, gently re-heat and serve.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "get ready",
                "where": [
                  "kitchen"
                ],
                "ingredients": [],
                "tools": [
                  "saucepans"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "have",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "butternut squash",
                  "apple"
                ],
                "tools": [
                  "fork"
                ],
                "temperature": "simmer",
                "time": "until just tender"
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "cauliflower",
                  "water"
                ],
                "tools": [],
                "temperature": "rolling boil",
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "bring",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "rolling boil",
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "reduce",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "simmer",
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "simmer",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "simmer",
                "time": "until very tender"
              },
              {
                "order": 7,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "blend",
                "where": [
                  "blender"
                ],
                "ingredients": [
                  "cauliflower",
                  "Braggs liquid aminos",
                  "curry powder",
                  "ginger powder",
                  "sriracha",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "mix",
                "where": [
                  "kitchen"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "mix",
                "where": [
                  "kitchen"
                ],
                "ingredients": [
                  "butternut squash",
                  "apple"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "kitchen"
                ],
                "ingredients": [
                  "block lite tofu"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "re-heat",
                "where": [
                  "kitchen"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "serve",
                "where": [
                  "kitchen"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          },
          "main": {
            "recipe_id": 665777,
            "title": "Zucchini Ribbon Caper Salad",
            "servings": 3,
            "price_per_serving": 66.59,
            "ready_in_minutes": 0,
            "ingredients": [
              "capers",
              "garlic",
              "lemon zest",
              "olive oil",
              "salt and pepper",
              "tomato",
              "zucchini"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Toss the zucchini strips with the oil, lemon zest and juice, garlic, salt and pepper. Set aside for 30 minutes to marinate.</li><li>Divide between 2-3 plates and top with capers, tomato julienne. Drizzle any extra dressing over if desired. To garnish, sprinkle a pinch of dried parsley over.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "toss",
                "where": [
                  "aside"
                ],
                "ingredients": [
                  "zucchini",
                  "oil",
                  "lemon zest",
                  "garlic",
                  "salt",
                  "pepper"
                ],
                "tools": [],
                "temperature": null,
                "time": "30 minutes"
              },
              {
                "order": 2,
                "preparation_action": "divide",
                "where": [
                  "plates"
                ],
                "ingredients": [
                  "capers",
                  "tomato"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "top",
                "where": [
                  "plates"
                ],
                "ingredients": [
                  "capers",
                  "tomato"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "drizzle",
                "where": [
                  "plates"
                ],
                "ingredients": [
                  "dressing"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "garnish",
                "where": [
                  "plates"
                ],
                "ingredients": [
                  "parsley"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          },
          "dessert": {
            "recipe_id": 664474,
            "title": "Vegan Pumpkin Pie Butter Cups",
            "servings": 16,
            "price_per_serving": 272.35,
            "ready_in_minutes": 0,
            "ingredients": [
              "chocolate pie crust",
              "cocoa powder",
              "walnuts",
              "coconut",
              "medjool dates",
              "chocolate shell",
              "cocoa powder",
              "tbs coconut oil",
              "maple syrup",
              "pumpkin puree",
              "peanut butter",
              "maple syrup",
              "chia seeds",
              "pumpkin pie spice"
            ],
            "restrictions": [
              "dairy free"
            ],
            "instructions": "Line 16 muffin cups with paper or silicone liners. The butter cups are easier to take out if you use paper liners.\nIn a food processor, blend all of the chocolate crust ingredients together.\nDrop a tablespoon of the crust into each cup and flatten it at the bottom.\nIn a small bowl, mix the ingredients for the pumpkin filling together. Freeze it for 5-10 minutes.\nMix the chocolate shell ingredients together until it looks like chocolate sauce.\nRemove the pumpkin filling and drop -tablespoon dollops of the pie filling into each cup.\nPour about 2 teaspoons of chocolate sauce into each cup so that you could just about cover up the pumpkin filling.\nFreeze the cups for 30 minutes to an hour.\nStore in the refrigerator. The chocolate will turn gooey if you leave the cups out in room temperature for a long time.\nEnjoy!",
            "structured_instructions": [
              {
                "order": 1,
                "preparation": "line",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [
                  "paper liners",
                  "silicone liners"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation": "use",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation": "blend",
                "where": [
                  "food processor"
                ],
                "ingredients": [
                  "chocolate crust"
                ],
                "tools": [
                  "food processor"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation": "drop",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [
                  "crust"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation": "flatten",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation": "mix",
                "where": [
                  "small bowl"
                ],
                "ingredients": [
                  "pumpkin filling"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation": "freeze",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "5-10 minutes"
              },
              {
                "order": 8,
                "preparation": "mix",
                "where": [],
                "ingredients": [
                  "chocolate shell"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation": "drop",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [
                  "pie filling"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation": "pour",
                "where": [
                  "muffin cups"
                ],
                "ingredients": [
                  "chocolate sauce"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation": "freeze",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "30 minutes to an hour"
              },
              {
                "order": 13,
                "preparation": "store",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 14,
                "preparation": "enjoy",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          }
        },
        "features": {
          "total_price_per_serving": 480.38,
          "price_category": "premium",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": false,
          "common_dietary_restrictions": [
            "dairy free"
          ],
          "is_vegetarian": false,
          "is_vegan": false,
          "is_gluten_free": false,
          "is_dairy_free": true,
          "cultura": "Mediterranean",
          "estilo_cocina": "Moderno/Vegano"
        },
        "similarity_features": {
          "total_ingredients_count": 28,
          "complexity_score": 60.0,
          "health_factor": 53.3,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_029",
      "description": "Interactive Test: Low user rating triggers revision",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.06835007667541504,
      "iterations": 1,
      "final_menu": {
        "menu_id": 2,
        "menu_name": "Menu 2: Simple Squash Salad",
        "description": "Complete menu featuring Simple Squash Salad as main course",
        "courses": {
          "starter": {
            "recipe_id": 650871,
            "title": "Maple & Curry Acorn Squash",
            "servings": 3,
            "price_per_serving": 57.52,
            "ready_in_minutes": 0,
            "ingredients": [
              "acorn squash",
              "curry powder",
              "maple syrup",
              "olive oil",
              "salt"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Preheat oven to 400 F. Line a baking sheet with parchment paper or a silicone mat.</li><li>Rinse the outside of the acorn squash and then chop it in half. Seed the squash and chop off the stem. Next, slice it into one-inch wedges. I like use the natural grooves on the squash as a guide for thickness.</li><li>Place the sliced acorn squash in a medium-sized bowl. Add the rest of the ingredients to the bowl and stir until everything is well incorporated.</li><li>Lay the acorn squash in a single layer on top of the lined baking sheet, cut side down.</li><li>Bake for about 15 minutes. Flip the acorn squash slices to the other side so that both sides will be browned equally.</li><li>Bake the squash for another 10 to 15 minutes or until the pieces can be easily pierced with a fork.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": "400 F",
                "time": null
              },
              {
                "order": 1,
                "preparation_action": "line",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [
                  "parchment paper",
                  "silicone mat"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "rinse",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "seed",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "chop",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "slice",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "place",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "add",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "curry powder",
                  "maple syrup",
                  "olive oil",
                  "salt"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "stir",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "lay",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "acorn squash"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "15 minutes"
              },
              {
                "order": 5,
                "preparation_action": "flip",
                "where": [
                  "acorn squash"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "bake",
                "where": [
                  "oven"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "10 to 15 minutes"
              }
            ]
          },
          "main": {
            "recipe_id": 660146,
            "title": "Simple Squash Salad",
            "servings": 6,
            "price_per_serving": 57.39,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "pepper",
              "parsley",
              "garlic",
              "garlic powder",
              "capers plus 2 tablespoons caper juice",
              "lemon",
              "onion",
              "oregano",
              "pepper flakes",
              "salt",
              "sugar",
              "vinegar",
              "zucchini"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "<ol><li>Combine all of the ingredients the salad ingredients in a bowl.</li><li>Combine all of the dressing ingredients in a cup and stir, adjust the ingredients to taste. </li><li> Pour this over the salad and toss. </li><li> Let the salad sit in the refrigerator for a few hours before serving.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "pepper",
                  "parsley",
                  "garlic",
                  "garlic powder",
                  "capers",
                  "caper juice",
                  "lemon",
                  "onion",
                  "oregano",
                  "pepper flakes",
                  "salt",
                  "sugar",
                  "vinegar",
                  "zucchini"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [
                  "cup"
                ],
                "ingredients": [
                  "dressing ingredients"
                ],
                "tools": [
                  "stir"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "pour",
                "where": [],
                "ingredients": [
                  "dressing"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "toss",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "a few hours"
              }
            ]
          },
          "dessert": {
            "recipe_id": 665330,
            "title": "Wild Blackberry Sorbet With Garden Mint & Lavender",
            "servings": 4,
            "price_per_serving": 102.5,
            "ready_in_minutes": 0,
            "ingredients": [
              "blackberries",
              "sugar",
              "water",
              "mint leaves",
              "lavender",
              "ice water"
            ],
            "restrictions": [
              "vegan",
              "gluten free",
              "vegetarian",
              "dairy free"
            ],
            "instructions": "Lay the clean, drained berries in a single layer on a cookie sheet and place in the freezer until frozen through. It is best to do both this and the next step the day or night before you plan to make the sorbet - just make sure you leave enough time for everything to freeze.\nMake the herb-infused simple syrup by combining the water and sugar in a small heavy-bottomed saucepan and heat over a medium flame until it comes to a boil. Turn it off and let cool completely.\nStrain out the mint leaves and lavender and pour the cooled syrup into an ice cube tray - should make roughly 4 syrup cubes. Place the tray in the freezer until syrup is frozen (the cubes may remain a little mushy as a result of all the sugar.)\nOnce the berries and herb-infused syrup cubes have frozen, you can make the sorbet. Place the frozen berries and syrup cubes in the bowl of a cuisinart or blender and add a few teaspoons of ice water to aid in blending. Continue to process or blend, adding small amounts of the ice water as needed, until smooth.\nServe, topped with a sprig of mint leaves and/or lavender.",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "lay",
                "where": [
                  "cookie sheet"
                ],
                "ingredients": [
                  "berries"
                ],
                "tools": [],
                "temperature": null,
                "time": "until frozen through"
              },
              {
                "order": 2,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "water",
                  "sugar"
                ],
                "tools": [
                  "saucepan"
                ],
                "temperature": "medium",
                "time": "until it comes to a boil"
              },
              {
                "order": 3,
                "preparation_action": "turn off and let cool",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "completely"
              },
              {
                "order": 4,
                "preparation_action": "strain and pour",
                "where": [
                  "ice cube tray"
                ],
                "ingredients": [
                  "mint leaves",
                  "lavender",
                  "syrup"
                ],
                "tools": [],
                "temperature": null,
                "time": "until syrup is frozen"
              },
              {
                "order": 5,
                "preparation_action": "make",
                "where": [],
                "ingredients": [
                  "berries",
                  "syrup cubes",
                  "ice water"
                ],
                "tools": [
                  "cuisinart",
                  "blender"
                ],
                "temperature": null,
                "time": "until smooth"
              },
              {
                "order": 6,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ]
          }
        },
        "features": {
          "total_price_per_serving": 217.41,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "vegetarian",
            "vegan",
            "dairy free",
            "gluten free"
          ],
          "is_vegetarian": true,
          "is_vegan": true,
          "is_gluten_free": true,
          "is_dairy_free": true,
          "cultura": "American",
          "estilo_cocina": "Moderno"
        },
        "similarity_features": {
          "total_ingredients_count": 23,
          "complexity_score": 50.0,
          "health_factor": 75.0,
          "cuisine_diversity": 0
        }
      },
      "case_saved": false,
      "error": null,
      "success": true
    },
    {
      "test_id": "TEST_030",
      "description": "Edge Case: Invalid event type",
      "status": "PASS",
      "passed": true,
      "execution_time": 0.10956645011901855,
      "iterations": 1,
      "final_menu": {
        "menu_id": 1,
        "menu_name": "Menu 1: Corn Salsa",
        "description": "Complete menu featuring Corn Salsa as main course",
        "courses": {
          "starter": {
            "recipe_id": 640062,
            "title": "Corn Avocado Salsa",
            "servings": 2,
            "price_per_serving": 130.73,
            "ready_in_minutes": 0,
            "ingredients": [
              "avocado",
              "balsamic vinegar",
              "cumin",
              "corn",
              "garlic",
              "bell pepper"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Preheat oven to 375 degrees.</li><li>Spread corn flat on a baking sheet.</li><li>Spray lightly with olive oil spray.</li><li>Roast corn in the oven for about 8-10 minutes. (Be careful not to brown too much or burn.)</li><li>Remove from heat and allow to cool.</li><li>Finely chop red pepper and garlic and mix in a bowl.</li><li>Peel and coarsely chop avocado and add to bowl.</li><li>Add cooled corn.</li><li>Mix in cumin and vinegar and blend well.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "preheat",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "375 degrees",
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "spray",
                "where": [],
                "ingredients": [],
                "tools": [
                  "olive oil spray"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "roast",
                "where": [
                  "oven"
                ],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": "8-10 minutes"
              },
              {
                "order": 5,
                "preparation_action": "remove",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "allow",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "red pepper",
                  "garlic"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "peel",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 9,
                "preparation_action": "chop",
                "where": [],
                "ingredients": [
                  "avocado"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 10,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "corn"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 11,
                "preparation_action": "mix",
                "where": [
                  "bowl"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 12,
                "preparation_action": "add",
                "where": [],
                "ingredients": [
                  "cumin",
                  "vinegar"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 13,
                "preparation_action": "blend",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [],
              "original_ingredients": [
                "avocado",
                "balsamic vinegar",
                "cumin",
                "corn",
                "garlic",
                "bell pepper"
              ],
              "ingredients_substituted": 0,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 0,
                "culture_changed_this_round": 0,
                "culture_pending_next_rounds": 0,
                "pending_ingredients": [],
                "max_per_round": 3
              }
            }
          },
          "main": {
            "recipe_id": 640104,
            "title": "Corn Salsa",
            "servings": 4,
            "price_per_serving": 150.92,
            "ready_in_minutes": 0,
            "ingredients": [
              "bell pepper",
              "celery",
              "ears of corn - boil and from the cob",
              "basil",
              "garlic",
              "jalapeño",
              "onion",
              "salt",
              "sugar",
              "marinated jalapeno",
              "vine tomato",
              "vinegar"
            ],
            "restrictions": [
              "vegan",
              "dairy free",
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Combine all of the above ingredients in a bowl.</li><li>Combine the ingredients for the dressing and add to the salsa.</li><li>Serve chilled.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "combine",
                "where": [
                  "bowl"
                ],
                "ingredients": [
                  "bell pepper",
                  "celery",
                  "ears of corn",
                  "basil",
                  "garlic",
                  "jalapeño",
                  "onion",
                  "salt",
                  "sugar",
                  "pickle",
                  "vine tomato"
                ],
                "tools": [
                  "bowl"
                ],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "combine",
                "where": [],
                "ingredients": [
                  "vinegar",
                  "salsa"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "serve",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": "chilled",
                "time": null
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "ears of corn - boil and from the cob",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "jalapeño",
                  "substitute": null,
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (not_found): 0 candidatos",
                    "fallback conocidos: 0 candidatos"
                  ],
                  "action": "kept",
                  "note": "Mantenido (solo viola cultura, no restricción alimentaria)"
                },
                {
                  "original": "pickle",
                  "substitute": "marinated jalapeno",
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 1 candidatos"
                  ],
                  "candidates_found": 1,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "bell pepper",
                "celery",
                "ears of corn - boil and from the cob",
                "basil",
                "garlic",
                "jalapeño",
                "onion",
                "salt",
                "sugar",
                "pickle",
                "vine tomato",
                "vinegar"
              ],
              "ingredients_substituted": 1,
              "ingredients_removed": 0,
              "ingredients_kept": 2,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 4,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 1,
                "pending_ingredients": [
                  "vine tomato"
                ],
                "max_per_round": 3
              }
            }
          },
          "dessert": {
            "recipe_id": 655202,
            "title": "Peanut Brittle",
            "servings": 4,
            "price_per_serving": 107.1,
            "ready_in_minutes": 0,
            "ingredients": [
              "butter",
              "carbonated water",
              "strawberry",
              "honey",
              "peanuts",
              "salt",
              "sugar",
              "water"
            ],
            "restrictions": [
              "gluten free",
              "vegetarian"
            ],
            "instructions": "<ol><li>Pour sugar, corn syrup and water into saucepan. Cook, stirring only until sugar is dissolved. Continue cooking until sugar begins to turn light brown (300 degrees) by candy thermometer. Remove from heat. Add salt, soda, butter and stir as little as possible, only to mix well. Stir in peanuts and coconut.Spread on a greased sheet of waxed paper set on top of a baking sheet and let the mixture cool and harden.</li></ol>",
            "structured_instructions": [
              {
                "order": 1,
                "preparation_action": "pour",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 2,
                "preparation_action": "cook",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "sugar",
                  "corn syrup",
                  "water"
                ],
                "tools": [
                  "candy thermometer"
                ],
                "temperature": "300 degrees",
                "time": null
              },
              {
                "order": 3,
                "preparation_action": "remove",
                "where": [
                  "saucepan"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 4,
                "preparation_action": "add",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 5,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "salt",
                  "soda",
                  "butter"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 6,
                "preparation_action": "stir",
                "where": [
                  "saucepan"
                ],
                "ingredients": [
                  "peanuts",
                  "coconut"
                ],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 7,
                "preparation_action": "spread",
                "where": [
                  "baking sheet"
                ],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": null
              },
              {
                "order": 8,
                "preparation_action": "let",
                "where": [],
                "ingredients": [],
                "tools": [],
                "temperature": null,
                "time": "cool and harden"
              }
            ],
            "_adaptation": {
              "substitutions": [
                {
                  "original": "soda",
                  "substitute": "carbonated water",
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (subcategory): 3 candidatos"
                  ],
                  "candidates_found": 3,
                  "action": "substituted"
                },
                {
                  "original": "coconut",
                  "substitute": "strawberry",
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (category): 33 candidatos"
                  ],
                  "candidates_found": 33,
                  "action": "substituted"
                },
                {
                  "original": "corn syrup",
                  "substitute": "honey",
                  "reason": [
                    "no pertenece a cultura 'italian'"
                  ],
                  "search_attempts": [
                    "ontología (category): 7 candidatos"
                  ],
                  "candidates_found": 7,
                  "action": "substituted"
                }
              ],
              "original_ingredients": [
                "butter",
                "soda",
                "coconut",
                "corn syrup",
                "peanuts",
                "salt",
                "sugar",
                "water"
              ],
              "ingredients_substituted": 3,
              "ingredients_removed": 0,
              "ingredients_kept": 0,
              "removed_ingredients": [],
              "culture_adaptation": {
                "total_culture_violations": 4,
                "culture_changed_this_round": 3,
                "culture_pending_next_rounds": 1,
                "pending_ingredients": [
                  "peanuts"
                ],
                "max_per_round": 3
              }
            }
          }
        },
        "features": {
          "total_price_per_serving": 388.75,
          "price_category": "moderate",
          "avg_ready_time_minutes": 0,
          "time_category": "quick",
          "season": "Summer",
          "wine_pairing": " No wine pairing",
          "is_kosher": true,
          "is_halal": true,
          "common_dietary_restrictions": [
            "gluten free",
            "vegetarian"
          ],
          "is_vegetarian": true,
          "is_vegan": false,
          "is_gluten_free": true,
          "is_dairy_free": false,
          "cultura": "American",
          "estilo_cocina": "Tradicional"
        },
        "similarity_features": {
          "total_ingredients_count": 22,
          "complexity_score": 52.0,
          "health_factor": 61.7,
          "cuisine_diversity": 0
        }
      },
      "case_saved": true,
      "error": null,
      "success": true
    }
  ]
}